import{S as t,i as e,s as a,e as l,t as i,c as n,a as o,g as s,d as r,f as u,F as d,h as c,k as g,n as f,b as h,G as m,H as p,a4 as v,a5 as w,j as E,m as k,o as b,a6 as S,v as y,r as I,w as $,Q as D,R as T,z as V,a7 as x,l as N,u as O,M as _,N as M,L,B as H}from"../../chunks/vendor-5d015fce.js";import{T as j}from"../../chunks/index-b7ca9129.js";import{T as B,n as C,x as P,a as R,g as F}from"../../chunks/requests-b02e315d.js";import{a as A,s as U,b as K}from"../../chunks/store-50f97f41.js";/* empty css                                                       */function q(t){let e,a,g,f,h,m,p=t[2].frame+"",v=t[2].timestamp.toFixed(3)+"";return{c(){e=l("h6"),a=i("Frame: "),g=i(p),f=i(" at time t="),h=i(v),m=i(" seconds.")},l(t){e=n(t,"H6",{});var l=o(e);a=s(l,"Frame: "),g=s(l,p),f=s(l," at time t="),h=s(l,v),m=s(l," seconds."),l.forEach(r)},m(t,l){u(t,e,l),d(e,a),d(e,g),d(e,f),d(e,h),d(e,m)},p(t,e){4&e&&p!==(p=t[2].frame+"")&&c(g,p),4&e&&v!==(v=t[2].timestamp.toFixed(3)+"")&&c(h,v)},d(t){t&&r(e)}}}function z(t){let e,a,i,s,c,v,w=t[0]&&q(t);return{c(){e=l("div"),w&&w.c(),a=g(),i=l("img"),this.h()},l(t){e=n(t,"DIV",{ref:!0,class:!0});var l=o(e);w&&w.l(l),a=f(l),i=n(l,"IMG",{src:!0,alt:!0}),l.forEach(r),this.h()},h(){i.src!==(s=t[1])&&h(i,"src",s),h(i,"alt",W),h(e,"ref","display"),h(e,"class","image-display")},m(t,l){u(t,e,l),w&&w.m(e,null),d(e,a),d(e,i),c||(v=m(e,"click",J),c=!0)},p(t,[l]){t[0]?w?w.p(t,l):(w=q(t),w.c(),w.m(e,a)):w&&(w.d(1),w=null),2&l&&i.src!==(s=t[1])&&h(i,"src",s)},i:p,o:p,d(t){t&&r(e),w&&w.d(),c=!1,v()}}}let W="carla viewer";function J(){console.log(frame)}function G(t,e,a){let{sensorName:l=""}=e,{showStats:i=!0}=e,{src:n=""}=e,{meta:o={frame:0,timestamp:0}}=e,{sensorData:s={}}=e;return t.$$set=t=>{"sensorName"in t&&a(3,l=t.sensorName),"showStats"in t&&a(0,i=t.showStats),"src"in t&&a(1,n=t.src),"meta"in t&&a(2,o=t.meta),"sensorData"in t&&a(4,s=t.sensorData)},[i,n,o,l,s]}class Q extends t{constructor(t){super(),e(this,t,G,z,a,{sensorName:3,showStats:0,src:1,meta:2,sensorData:4})}}var X=[{latitude:.0009193044393214223,longitude:.001347095566868799,altitude:8},{latitude:.0009013408065499107,longitude:.0013467830426305495,altitude:8},{latitude:.0008833772423031405,longitude:.0013464706554643343,altitude:8},{latitude:.0008654136780705812,longitude:.0013461581312260848,altitude:8},{latitude:.0008474500453132805,longitude:.0013458457440598695,altitude:8},{latitude:.0008294864810522995,longitude:.0013455332198216198,altitude:8},{latitude:.0008115228482949988,longitude:.0013452208326554045,altitude:8},{latitude:.0007935592840624395,longitude:.001344908308417155,altitude:8},{latitude:.0007755957198014585,longitude:.0013445959212509398,altitude:8},{latitude:.0007576321555688992,longitude:.0013442835340847245,altitude:8},{latitude:.0007440908092775089,longitude:.0013440479072577283,altitude:8},{latitude:.000728141244451308,longitude:.0013433584349250988,altitude:8},{latitude:.0007149488835977991,longitude:.001339595396366912,altitude:8},{latitude:.0007032210688748819,longitude:.0013324779309848462,altitude:8},{latitude:.0006936859954720376,longitude:.0013223914853394093,altitude:8},{latitude:.0006862020680244996,longitude:.0013096898423511814,altitude:8},{latitude:.0006814389518723374,longitude:.0012957382394819892,altitude:8},{latitude:.0006795931398784205,longitude:.0012811118309878399,altitude:8},{latitude:.0006799542561708449,longitude:.0012639390353121277,altitude:8},{latitude:.0006804274973575275,longitude:.0012459757452144924,altitude:8},{latitude:.0006804338026711321,longitude:.0012457376510908787,altitude:8},{latitude:.0006809069753330732,longitude:.001227777650722067,altitude:8},{latitude:.0006813801479808035,longitude:.0012098176503532552,altitude:8},{latitude:.0006818533206569555,longitude:.001191857512912409,altitude:8},{latitude:.0006823264933188966,longitude:.0011738975125435975,altitude:8},{latitude:.0006827995289029332,longitude:.0011559373751027515,altitude:8},{latitude:.0006832727015648743,longitude:.0011379773061979226,altitude:8},{latitude:.0006837458742410263,longitude:.0011200171687570765,altitude:8},{latitude:.0006842190469029674,longitude:.0011020570998522476,altitude:8},{latitude:.0006846922195506977,longitude:.0010840970309474187,altitude:8},{latitude:.0006851653922126388,longitude:.00106613696204259,altitude:8},{latitude:.00068563856487458,longitude:.001048176893137761,altitude:8},{latitude:.0006861116004728274,longitude:.0010302168242329322,altitude:8},{latitude:.0006865847731347685,longitude:.0010122567553281032,altitude:8},{latitude:.0006870579457967096,longitude:.0009942966864232745,altitude:8},{latitude:.0006875311184586508,longitude:.0009763366175184456,altitude:8},{latitude:.0006880042911063811,longitude:.0009583765486136167,altitude:8},{latitude:.000688477463782533,longitude:.0009404164797087878,altitude:8},{latitude:.0006889504993807805,longitude:.0009224563422679418,altitude:8},{latitude:.0006894236720285107,longitude:.0009044963418991301,altitude:8},{latitude:.0006898968446904519,longitude:.0008865362044582841,altitude:8},{latitude:.0006903700173381822,longitude:.0008685762040894723,altitude:8},{latitude:.000690843190028545,longitude:.0008506160666486263,altitude:8},{latitude:.0006909661436509396,longitude:.000845946433655447,altitude:8},{latitude:.0006914393162986698,longitude:.0008279864332866354,altitude:8},{latitude:.0006919225637460613,longitude:.000810368427643452,altitude:8},{latitude:.0006940348438035926,longitude:.0007954980309282131,altitude:8},{latitude:.0006988614242828817,longitude:.0007812750254310673,altitude:8},{latitude:.0007062358997274032,longitude:.0007681904031789492,altitude:8},{latitude:.0007152400245900026,longitude:.0007583182011231545,altitude:8},{latitude:.0007265528537203636,longitude:.0007518448372303584,altitude:8},{latitude:.0007393024719277719,longitude:.0007491362938321953,altitude:8},{latitude:.0007558530976297106,longitude:.0007495525816004252,altitude:8},{latitude:.0007595099053645527,longitude:.0007496818405287889,altitude:8},{latitude:.0007774707966916594,longitude:.0007503166211197248,altitude:8},{latitude:.0007954258624636168,longitude:.0007509511961026092,altitude:8},{latitude:.0008133809967887373,longitude:.0007515857710854937,altitude:8},{latitude:.000831336131099647,longitude:.000752220346068378,altitude:8},{latitude:.0008492911968573935,longitude:.0007528549210512625,altitude:8},{latitude:.0008672462626293509,longitude:.0007534894960341469,altitude:8},{latitude:.0008852013969402606,longitude:.0007541240710170313,altitude:8},{latitude:.0009031564627264288,longitude:.0007547586459999157,altitude:8},{latitude:.0009211115970515493,longitude:.0007553932209828001,altitude:8},{latitude:.000939066662795085,longitude:.0007560277959656846,altitude:8},{latitude:.0009570217285812532,longitude:.000756662370948569,altitude:8},{latitude:.0009749768628921629,longitude:.0007572969459314534,altitude:8},{latitude:.0009929319286641203,longitude:.0007579315209143378,altitude:8},{latitude:.00101088706297503,longitude:.0007585660958972223,altitude:8},{latitude:.0010288421287611982,longitude:.0007592006708801067,altitude:8},{latitude:.0010467972630436861,longitude:.000759835245862991,altitude:8},{latitude:.0010647523288156435,longitude:.0007604698208458755,altitude:8},{latitude:.00108270739457339,longitude:.0007611043958287599,altitude:8},{latitude:.0010959941980956955,longitude:.0007615740046183402,altitude:8},{latitude:.001113949263867653,longitude:.0007622085110652075,altitude:8},{latitude:.0011297418812148408,longitude:.0007634461344630827,altitude:8},{latitude:.0011440673480649366,longitude:.0007673733853183849,altitude:8},{latitude:.0011573507247675252,longitude:.0007740213104468876,altitude:8},{latitude:.0011690809382400857,longitude:.0007831341334325494,altitude:8},{latitude:.0011788060620006036,longitude:.0007943608813314944,altitude:8},{latitude:.001186151752321507,longitude:.0008072701884517171,altitude:8},{latitude:.0011908350925153854,longitude:.0008213653057408423,altitude:8},{latitude:.0011926762440879202,longitude:.0008361037020870311,altitude:8},{latitude:.0011923923679120207,longitude:.0008533243359027208,altitude:8},{latitude:.0011921774389520579,longitude:.000863359516607322,altitude:8},{latitude:.0011917926777584853,longitude:.0008813218472007171,altitude:8},{latitude:.0011914079165507019,longitude:.0008992839721860608,altitude:8},{latitude:.0011910230182650139,longitude:.0009172461657074217,altitude:8},{latitude:.0011906382570856522,longitude:.0009352083592287824,altitude:8},{latitude:.0011902534958778688,longitude:.0009531704842141261,altitude:8},{latitude:.0011898685976063916,longitude:.000971132677735487,altitude:8},{latitude:.0011894838363986082,longitude:.0009890948712568477,altitude:8},{latitude:.0011890990751908248,longitude:.0010070570647782086,altitude:8},{latitude:.001188714314011463,longitude:.0010250192582995695,altitude:8},{latitude:.001188329415725775,longitude:.0010429814518209302,altitude:8},{latitude:.0011879446545322025,longitude:.001060943645342291,altitude:8},{latitude:.0011875598933244191,longitude:.001078905838863652,altitude:8},{latitude:.0011871749950671528,longitude:.0010968680323850128,altitude:8},{latitude:.0011867902338593694,longitude:.0011148302259063735,altitude:8},{latitude:.001186405472651586,longitude:.0011327923508917172,altitude:8},{latitude:.0011860205743943197,longitude:.0011507546814851124,altitude:8},{latitude:.0011856358131865363,longitude:.0011687168750064733,altitude:8},{latitude:.0011852510519929638,longitude:.0011866789314557997,altitude:8},{latitude:.0011848661537072758,longitude:.0012046411249771606,altitude:8},{latitude:.0011844813924994924,longitude:.0012226033184985215,altitude:8},{latitude:.0011840966313201307,longitude:.0012405655120198821,altitude:8},{latitude:.001183796443555707,longitude:.0012545760558638319,altitude:8},{latitude:.0011830478931784683,longitude:.0012710123634991426,altitude:8},{latitude:.0011799839220003605,longitude:.0012859333397950456,altitude:8},{latitude:.0011744011151080258,longitude:.0013001057657115271,altitude:8},{latitude:.001166466015050105,longitude:.001313108007671019,altitude:8},{latitude:.0011564145227680456,longitude:.00132455324839267,altitude:8},{latitude:.0011445008383788036,longitude:.0013341885899731598,altitude:8},{latitude:.001131148788573455,longitude:.0013417167231700481,altitude:8},{latitude:.0011167327171222041,longitude:.0013469249121860708,altitude:8},{latitude:.0011016523260565236,longitude:.001349669094313157,altitude:8},{latitude:.0010855786425025826,longitude:.0013499876497209168,altitude:8},{latitude:.0010809767230881562,longitude:.0013499075996528738,altitude:8},{latitude:.0010630131588555969,longitude:.0013495952124866586,altitude:8},{latitude:.0010450495260556636,longitude:.001349282688248409,altitude:8},{latitude:.0010270859618373152,longitude:.0013489703010821938,altitude:8},{latitude:.0010091223290658036,longitude:.001348657776843944,altitude:8},{latitude:.0009911587648332443,longitude:.0013483453896777288,altitude:8},{latitude:.0009731952005864741,longitude:.0013480328654394793,altitude:8},{latitude:.0009552315678149625,longitude:.001347720478273264,altitude:8},{latitude:.0009372680035539815,longitude:.0013474079540350145,altitude:8}],Y=[{latitude:.0009193044393214223,longitude:.001347095566868799,altitude:8},{latitude:.0008084837556765478,longitude:.0013115403148145012,altitude:8},{latitude:.0007186522272633056,longitude:.001383405537544063,altitude:8},{latitude:.0006288206988642742,longitude:.0013115403148145012,altitude:8},{latitude:.0005389891704510319,longitude:.001383405537544063,altitude:7.5},{latitude:.0004491576420520005,longitude:.0013115403148145012,altitude:6},{latitude:.0003593261136387582,longitude:.001383405537544063,altitude:5},{latitude:.00026949458522551595,longitude:.0013115403148145012,altitude:3},{latitude:.00017966305681227368,longitude:.001383405537544063,altitude:2.5},{latitude:8983152841324227e-20,longitude:.0013115403148145012,altitude:2},{latitude:0,longitude:.001383405537544063,altitude:2},{latitude:-8983152842745312e-20,longitude:.0013115403148145012,altitude:2},{latitude:-.00017966305682648454,longitude:.001383405537544063,altitude:1},{latitude:-.00026949458522551595,longitude:.0013115403148145012,altitude:1}];function Z(t){let e,a,p,T,V,x,N,O,_,M,L,H,j,C,P,R,F,A,U,K,q,z,W,J,G,X,Y,Z,tt,et,at,lt,it,nt,ot,st,rt,ut,dt,ct,gt,ft,ht,mt,pt,vt,wt,Et,kt,bt,St,yt,It,$t,Dt,Tt,Vt,xt,Nt,Ot,_t,Mt,Lt,Ht,jt,Bt,Ct,Pt,Rt,Ft,At,Ut,Kt,qt,zt,Wt,Jt,Gt,Qt,Xt,Yt,Zt,te,ee,ae,le,ie,ne,oe,se,re,ue,de,ce,ge=t[5].throttle.toFixed(3)+"",fe=t[5].brake.toFixed(3)+"",he=t[5].steer.toFixed(3)+"";function me(e){t[17](e)}function pe(e){t[18](e)}e=new B({});let ve={sensorName:"autopilot-camera1",showStats:!0};function we(e){t[19](e)}function Ee(e){t[20](e)}void 0!==t[0]&&(ve.src=t[0]),void 0!==t[2]&&(ve.meta=t[2]),W=new Q({props:ve}),v.push((()=>w(W,"src",me))),v.push((()=>w(W,"meta",pe)));let ke={sensorName:"autopilot-camera2",showStats:!0};return void 0!==t[1]&&(ke.src=t[1]),void 0!==t[3]&&(ke.meta=t[3]),Y=new Q({props:ke}),v.push((()=>w(Y,"src",we))),v.push((()=>w(Y,"meta",Ee))),{c(){E(e.$$.fragment),a=g(),p=l("div"),T=l("div"),V=l("button"),x=i("Start Simulation"),N=g(),O=l("div"),_=l("div"),M=l("button"),L=i("Stop Simulation"),H=g(),j=l("hr"),C=g(),P=l("div"),R=l("div"),F=l("div"),A=l("div"),U=l("div"),K=l("h4"),q=i("Dash Cam"),z=g(),E(W.$$.fragment),X=g(),E(Y.$$.fragment),et=g(),at=l("div"),lt=l("h4"),it=i("Manual Control"),nt=g(),ot=l("input"),st=g(),rt=l("h4"),ut=i("Vehicle Inputs"),dt=g(),ct=l("div"),gt=l("div"),ft=l("label"),ht=i("Throttle:"),mt=g(),pt=l("div"),vt=l("div"),wt=i(ge),Et=g(),kt=l("div"),bt=l("div"),St=l("label"),yt=i("Brake:"),It=g(),$t=l("div"),Dt=l("div"),Tt=i(fe),Vt=g(),xt=l("div"),Nt=l("div"),Ot=l("label"),_t=i("Steer:"),Mt=g(),Lt=l("div"),Ht=l("div"),jt=i(he),Bt=g(),Ct=l("div"),Pt=l("div"),Rt=l("h4"),Ft=i("Position"),At=g(),Ut=l("p"),Kt=i(t[7]),qt=g(),zt=l("div"),Wt=l("h4"),Jt=i("Orientation"),Gt=g(),Qt=l("p"),Xt=i(t[8]),Yt=g(),Zt=l("div"),te=l("h4"),ee=i("Speed"),ae=g(),le=l("p"),ie=i(t[6]),ne=g(),oe=l("div"),se=l("button"),re=i("Reset Vehicle"),this.h()},l(l){k(e.$$.fragment,l),a=f(l),p=n(l,"DIV",{class:!0});var i=o(p);T=n(i,"DIV",{class:!0});var u=o(T);V=n(u,"BUTTON",{class:!0});var d=o(V);x=s(d,"Start Simulation"),d.forEach(r),u.forEach(r),i.forEach(r),N=f(l),O=n(l,"DIV",{class:!0});var c=o(O);_=n(c,"DIV",{class:!0});var g=o(_);M=n(g,"BUTTON",{class:!0});var h=o(M);L=s(h,"Stop Simulation"),h.forEach(r),g.forEach(r),c.forEach(r),H=f(l),j=n(l,"HR",{}),C=f(l),P=n(l,"DIV",{class:!0});var m=o(P);R=n(m,"DIV",{class:!0});var v=o(R);F=n(v,"DIV",{class:!0});var w=o(F);A=n(w,"DIV",{class:!0});var E=o(A);U=n(E,"DIV",{class:!0});var b=o(U);K=n(b,"H4",{});var S=o(K);q=s(S,"Dash Cam"),S.forEach(r),z=f(b),k(W.$$.fragment,b),X=f(b),k(Y.$$.fragment,b),b.forEach(r),et=f(E),at=n(E,"DIV",{class:!0});var y=o(at);lt=n(y,"H4",{});var I=o(lt);it=s(I,"Manual Control"),I.forEach(r),nt=f(y),ot=n(y,"INPUT",{type:!0}),st=f(y),rt=n(y,"H4",{});var $=o(rt);ut=s($,"Vehicle Inputs"),$.forEach(r),dt=f(y),ct=n(y,"DIV",{});var D=o(ct);gt=n(D,"DIV",{cols:!0,class:!0});var B=o(gt);ft=n(B,"LABEL",{for:!0});var J=o(ft);ht=s(J,"Throttle:"),J.forEach(r),B.forEach(r),mt=f(D),pt=n(D,"DIV",{class:!0});var G=o(pt);vt=n(G,"DIV",{class:!0});var Q=o(vt);wt=s(Q,ge),Q.forEach(r),G.forEach(r),D.forEach(r),Et=f(y),kt=n(y,"DIV",{});var Z=o(kt);bt=n(Z,"DIV",{class:!0});var tt=o(bt);St=n(tt,"LABEL",{for:!0});var ue=o(St);yt=s(ue,"Brake:"),ue.forEach(r),tt.forEach(r),It=f(Z),$t=n(Z,"DIV",{class:!0});var de=o($t);Dt=n(de,"DIV",{class:!0});var ce=o(Dt);Tt=s(ce,fe),ce.forEach(r),de.forEach(r),Z.forEach(r),Vt=f(y),xt=n(y,"DIV",{});var me=o(xt);Nt=n(me,"DIV",{class:!0});var pe=o(Nt);Ot=n(pe,"LABEL",{for:!0});var ve=o(Ot);_t=s(ve,"Steer:"),ve.forEach(r),pe.forEach(r),Mt=f(me),Lt=n(me,"DIV",{cols:!0,class:!0});var we=o(Lt);Ht=n(we,"DIV",{class:!0});var Ee=o(Ht);jt=s(Ee,he),Ee.forEach(r),we.forEach(r),me.forEach(r),Bt=f(y),Ct=n(y,"DIV",{class:!0});var ke=o(Ct);Pt=n(ke,"DIV",{});var be=o(Pt);Rt=n(be,"H4",{});var Se=o(Rt);Ft=s(Se,"Position"),Se.forEach(r),At=f(be),Ut=n(be,"P",{class:!0});var ye=o(Ut);Kt=s(ye,t[7]),ye.forEach(r),be.forEach(r),qt=f(ke),zt=n(ke,"DIV",{});var Ie=o(zt);Wt=n(Ie,"H4",{});var $e=o(Wt);Jt=s($e,"Orientation"),$e.forEach(r),Gt=f(Ie),Qt=n(Ie,"P",{class:!0});var De=o(Qt);Xt=s(De,t[8]),De.forEach(r),Ie.forEach(r),Yt=f(ke),Zt=n(ke,"DIV",{});var Te=o(Zt);te=n(Te,"H4",{});var Ve=o(te);ee=s(Ve,"Speed"),Ve.forEach(r),ae=f(Te),le=n(Te,"P",{class:!0});var xe=o(le);ie=s(xe,t[6]),xe.forEach(r),Te.forEach(r),ke.forEach(r),ne=f(y),oe=n(y,"DIV",{class:!0});var Ne=o(oe);se=n(Ne,"BUTTON",{class:!0});var Oe=o(se);re=s(Oe,"Reset Vehicle"),Oe.forEach(r),Ne.forEach(r),y.forEach(r),E.forEach(r),w.forEach(r),v.forEach(r),m.forEach(r),this.h()},h(){h(V,"class","w3-col w3-input w3-border"),h(T,"class","w3-rest"),h(p,"class","w3-row w3-section"),h(M,"class","w3-col w3-input w3-border"),h(_,"class","w3-rest"),h(O,"class","w3-row w3-section"),h(U,"class","col-xl-6"),h(ot,"type","checkbox"),h(ft,"for","range-throttle"),h(gt,"cols","2"),h(gt,"class","align-self-center"),h(vt,"class","mt-2"),h(pt,"class","align-self-center"),h(St,"for","range-brake"),h(bt,"class","align-self-center"),h(Dt,"class","mt-2"),h($t,"class","align-self-center"),h(Ot,"for","range-throttle"),h(Nt,"class","align-self-center"),h(Ht,"class","mt-2"),h(Lt,"cols","2"),h(Lt,"class","align-self-center"),h(Ut,"class","svelte-au1azq"),h(Qt,"class","svelte-au1azq"),h(le,"class","svelte-au1azq"),h(Ct,"class","mt-3"),h(se,"class","my-1 align-self-center"),h(oe,"class","text-center"),h(at,"class","col-xl-6"),h(A,"class","w3-container"),h(F,"class","autopilot"),h(R,"class","w3-responsive"),h(P,"class","w3-container")},m(l,i){b(e,l,i),u(l,a,i),u(l,p,i),d(p,T),d(T,V),d(V,x),u(l,N,i),u(l,O,i),d(O,_),d(_,M),d(M,L),u(l,H,i),u(l,j,i),u(l,C,i),u(l,P,i),d(P,R),d(R,F),d(F,A),d(A,U),d(U,K),d(K,q),d(U,z),b(W,U,null),d(U,X),b(Y,U,null),d(A,et),d(A,at),d(at,lt),d(lt,it),d(at,nt),d(at,ot),ot.checked=t[4],d(at,st),d(at,rt),d(rt,ut),d(at,dt),d(at,ct),d(ct,gt),d(gt,ft),d(ft,ht),d(ct,mt),d(ct,pt),d(pt,vt),d(vt,wt),d(at,Et),d(at,kt),d(kt,bt),d(bt,St),d(St,yt),d(kt,It),d(kt,$t),d($t,Dt),d(Dt,Tt),d(at,Vt),d(at,xt),d(xt,Nt),d(Nt,Ot),d(Ot,_t),d(xt,Mt),d(xt,Lt),d(Lt,Ht),d(Ht,jt),d(at,Bt),d(at,Ct),d(Ct,Pt),d(Pt,Rt),d(Rt,Ft),d(Pt,At),d(Pt,Ut),d(Ut,Kt),d(Ct,qt),d(Ct,zt),d(zt,Wt),d(Wt,Jt),d(zt,Gt),d(zt,Qt),d(Qt,Xt),d(Ct,Yt),d(Ct,Zt),d(Zt,te),d(te,ee),d(Zt,ae),d(Zt,le),d(le,ie),d(at,ne),d(at,oe),d(oe,se),d(se,re),ue=!0,de||(ce=[m(V,"click",t[11]),m(M,"click",t[12]),m(ot,"change",t[21]),m(ot,"change",t[9]),m(se,"click",t[10])],de=!0)},p(t,e){const a={};!J&&1&e[0]&&(J=!0,a.src=t[0],S((()=>J=!1))),!G&&4&e[0]&&(G=!0,a.meta=t[2],S((()=>G=!1))),W.$set(a);const l={};!Z&&2&e[0]&&(Z=!0,l.src=t[1],S((()=>Z=!1))),!tt&&8&e[0]&&(tt=!0,l.meta=t[3],S((()=>tt=!1))),Y.$set(l),16&e[0]&&(ot.checked=t[4]),(!ue||32&e[0])&&ge!==(ge=t[5].throttle.toFixed(3)+"")&&c(wt,ge),(!ue||32&e[0])&&fe!==(fe=t[5].brake.toFixed(3)+"")&&c(Tt,fe),(!ue||32&e[0])&&he!==(he=t[5].steer.toFixed(3)+"")&&c(jt,he),(!ue||128&e[0])&&c(Kt,t[7]),(!ue||256&e[0])&&c(Xt,t[8]),(!ue||64&e[0])&&c(ie,t[6])},i(t){ue||(y(e.$$.fragment,t),y(W.$$.fragment,t),y(Y.$$.fragment,t),ue=!0)},o(t){I(e.$$.fragment,t),I(W.$$.fragment,t),I(Y.$$.fragment,t),ue=!1},d(t){$(e,t),t&&r(a),t&&r(p),t&&r(N),t&&r(O),t&&r(H),t&&r(j),t&&r(C),t&&r(P),$(W),$(Y),de=!1,D(ce)}}}let tt="data:image/jpeg;base64,",et=.1;function at(t,e){let a=0;for(let l=0;l<3;l++)a+=t[l]*e[l];return a}function lt(t){return Math.sqrt(at(t,t))}function it(t,e,a){let{time_limit:l=30}=e,{attack_time:i=20}=e,n=!1,o=!1,s=!1,{title:r}=e,{input_data:u}=e,d="",c="",g={timestamp:0,frame:0},f={timestamp:0,frame:0},h={};const m=A.subscribe((t=>{h=t}));T((()=>{m()}));let p,v,w,E=[{name:"autopilot-gnss",type:"gnss"},{name:"autopilot-imu",type:"imu"},{name:"autopilot-tachometer",type:"tachometer"},{name:"autopilot-camera1",type:"camera"},{name:"autopilot-camera2",type:"camera"}],k=!1,b=null,S=!1,y=0,I=0,$=[0,-1,0],D={throttle:0,brake:0,steer:0},N={Kp:.5,Ki:.001,Kd:.02,tau:1,integrator:0,differentiator:0,lastError:0,lastMeasurement:0},O={Kp:.01,Ki:0,Kd:.01,tau:1,integrator:0,differentiator:0,lastError:0,lastMeasurement:0},_={},M="",L="-",H="",j="Lat: -, Lon: -, Alt: -",B="",P="-";function R(t){let e=_[t];return e||null}function F(t){let e=String.fromCharCode(t.keyCode).toLowerCase();k&&b===e||(k=!0,b=e,"w"===e?a(5,D.throttle=1,D):"a"===e?a(5,D.steer=-1,D):"s"===e?a(5,D.brake=1,D):"d"===e&&a(5,D.steer=1,D),K())}function U(t){k=!1;let e=String.fromCharCode(t.keyCode).toLowerCase();"w"===e?a(5,D.throttle=0,D):"a"===e?a(5,D.steer=0,D):"s"===e?a(5,D.brake=0,D):"d"===e&&a(5,D.steer=0,D),K()}function K(){x({method:"POST",url:"/control",data:D,headers:{"content-type":"application/json"}}).catch((function(t){C.danger("apply control failed")}))}function q(){w=performance.now();let t=(w-v)/1e3;t>l&&(o=!0),t>i&&(s=!0,console.log("starting the attack!"));let e=_["autopilot-tachometer"].speed,r=_["autopilot-gnss"],u=_["autopilot-imu"].orientation,d=p[I];n&&s&&(W?(r.longitude+=.002,W=!W):r.longitude-=.002);let c=function(t,e){let a=e-t,l=t,i=N.Kp*a,n=N.integrator+.5*N.Ki*et*(N.lastError+a),o=(2*N.Kd*(l-N.lastMeasurement)+(2*N.tau-et)*N.differentiator)/(2*N.tau+et),s=Math.min(Math.max(i+n+o,-1),1);return N.integrator=n,N.differentiator=o,N.lastError=a,N.lastMeasurement=l,s}(e,5),g=function(t,e,a){let l=[60*(a.longitude-t.longitude)*1852,60*-(a.latitude-t.latitude)*1852,0],i=Math.acos(Math.min(Math.max(at(l,$)/(lt(l)*lt($)),-1),1));i=i/Math.PI*180,function(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}($,l)[2]<0&&(i=360-i);let n=i-e;n>180?n-=360:n<-180&&(n+=360);let o=e,s=O.Kp*n,r=O.integrator+.5*O.Ki*et*(O.lastError+n),u=(2*O.Kd*(o-O.lastMeasurement)+(2*O.tau-et)*O.differentiator)/(2*O.tau+et),d=Math.min(Math.max(s+r+u,-1),1);O.integrator=r,O.differentiator=u,O.lastError=n,O.lastMeasurement=o,lt(l)<2&&I++;I>=p.length&&(I=0);return d}(r,u,d);c>=0?(a(5,D.throttle=Math.min(c,.75),D),a(5,D.brake=0,D)):(a(5,D.throttle=0,D),a(5,D.brake=Math.min(Math.abs(c),1),D)),g>D.steer+.1?g=D.steer+.1:g<D.steer-.1&&(g=D.steer-.1),a(5,D.steer=g>=0?Math.min(1,g):Math.max(-1,g),D),K(),o&&(y&&clearInterval(y),z(),K())}function z(){I=0,a(5,D.throttle=0,D),a(5,D.brake=1,D),a(5,D.steer=0,D),N.integrator=0,N.differentiator=0,N.lastError=0,N.lastMeasurement=0,O.integrator=0,O.differentiator=0,O.lastError=0,O.lastMeasurement=0,x({method:"POST",url:"/config",headers:{"content-type":"application/json"},data:{simulation:{reset:!0}}}).then((()=>{console.log("Simulation was reset!")}),(t=>{console.log(t)}))}V((async()=>{if(h.configurations.length>0){let t=h.configurations[0],e=t.driving_path;a(13,l=t.driving_time),a(14,i=t.driving_attack_time),"No Attack"==t.driving_attacks&&(n=!1),"Attack Mode"==t.driving_attacks&&(n=!0),"testrun"==e?p=X:(e="zickzack")&&(p=Y)}console.log("scenario_configurations",h),x({method:"POST",url:"/config",headers:{"content-type":"application/json"},data:{newSensors:E}}).then((t=>{E.forEach((t=>{!function(t){let e="http://localhost:8000/sensor/"+t.type+"/"+t.name+"/websocket";e=e.replace("http","ws");let l=new WebSocket(e);l.onopen=function(){console.log("WebSocket connection established with "+e)},l.onmessage=function(e){let l=JSON.parse(e.data);_[t.name]=l,"autopilot-camera1"==t.name&&(a(0,d=tt+l.image),a(2,g={timestamp:l.timestamp,frame:l.frame})),"autopilot-camera2"==t.name&&(a(1,c=tt+l.image),a(3,f={timestamp:l.timestamp,frame:l.frame})),"autopilot-tachometer"==t.name&&(M=R("autopilot-tachometer"),M&&a(6,L=M.speed.toFixed(3)+" m/s")),"autopilot-gnss"==t.name&&(H=R("autopilot-gnss"),H&&a(7,j="Lat: "+H.latitude+" °\nLon: "+H.longitude+" °\nAlt: "+H.altitude.toFixed(2)+" m")),"autopilot-imu"==t.name&&(B=R("autopilot-imu"),B&&a(8,P=B.orientation.toFixed(3)+" °"))}}(t)}));let e={enabled:!0,updateInterval:.1,imageWidth:800,imageHeight:600,fov:90},l="/sensor/camera/autopilot-camera1";x({method:"POST",url:l,data:{settings:e},headers:{"content-type":"application/json"}}).catch((function(t){C.danger("axos request 1 to carla failed")})),e.position={x:-6,y:0,z:5},e.rotation={roll:0,pitch:-35,yaw:0},l="/sensor/camera/autopilot-camera2",x({method:"POST",url:l,data:{settings:e},headers:{"content-type":"application/json"}}).catch((function(t){C.danger("axos request 2 to carla failed")}));l="/sensor/imu/autopilot-imu",x({method:"POST",url:l,data:{settings:{enabled:!0,updateInterval:.1}},headers:{"content-type":"application/json"}}).catch((function(t){C.danger("axos request 3 to carla failed")}));l="/sensor/gnss/autopilot-gnss",x({method:"POST",url:l,data:{settings:{enabled:!0,updateInterval:.1}},headers:{"content-type":"application/json"}}).catch((function(t){C.danger("axos request 4 to carla failed")}));l="/sensor/tachometer/autopilot-tachometer",x({method:"POST",url:l,data:{settings:{enabled:!0,updateInterval:.1}},headers:{"content-type":"application/json"}}).then((()=>{C.info("autopilot mode on.")})),C.success("The required sensors for the autopilot have been successfully created.")}),(t=>{C.danger("failed to call /config sensor")}))}));let W=!0;return t.$$set=t=>{"time_limit"in t&&a(13,l=t.time_limit),"attack_time"in t&&a(14,i=t.attack_time),"title"in t&&a(15,r=t.title),"input_data"in t&&a(16,u=t.input_data)},[d,c,g,f,S,D,L,j,P,function(){console.log("manual control:",S),S?(window.addEventListener("keydown",F),window.addEventListener("keyup",U),y&&clearInterval(y),a(5,D.throttle=0,D),a(5,D.brake=1,D),a(5,D.steer=0,D)):(window.removeEventListener("keydown",F),window.removeEventListener("keyup",U),y=setInterval(q,20))},z,function(){y&&clearInterval(y),o=!1,s=!1,v=performance.now(),w=performance.now(),a(4,S=!1),window.removeEventListener("keydown",F),window.removeEventListener("keyup",U),y=setInterval(q,20)},function(){o=!0,s=!1,clearInterval(y),z(),clearInterval(y)},l,i,r,u,function(t){d=t,a(0,d)},function(t){g=t,a(2,g)},function(t){c=t,a(1,c)},function(t){f=t,a(3,f)},function(){S=this.checked,a(4,S)}]}class nt extends t{constructor(t){super(),e(this,t,it,Z,a,{time_limit:13,attack_time:14,title:15,input_data:16},[-1,-1])}}function ot(t){let e,a,c,v,w,E,k,b,S,y;return{c(){e=l("div"),a=l("span"),c=i("×"),v=g(),w=l("img"),k=g(),b=l("div"),this.h()},l(t){e=n(t,"DIV",{id:!0,class:!0});var l=o(e);a=n(l,"SPAN",{class:!0});var i=o(a);c=s(i,"×"),i.forEach(r),v=f(l),w=n(l,"IMG",{class:!0,id:!0,src:!0}),k=f(l),b=n(l,"DIV",{id:!0,class:!0}),o(b).forEach(r),l.forEach(r),this.h()},h(){h(a,"class","close svelte-rk4oiy"),h(w,"class","modal-content svelte-rk4oiy"),h(w,"id","img01"),w.src!==(E="")&&h(w,"src",""),h(b,"id","caption"),h(b,"class","svelte-rk4oiy"),h(e,"id","myModal"),h(e,"class","modal svelte-rk4oiy")},m(t,l){u(t,e,l),d(e,a),d(a,c),d(e,v),d(e,w),d(e,k),d(e,b),S||(y=m(a,"click",st),S=!0)},p:p,i:p,o:p,d(t){t&&r(e),S=!1,y()}}}function st(){document.getElementById("myModal").style.display="none"}function rt(t,e){var a=document.getElementById("myModal"),l=document.getElementById("img01"),i=document.getElementById("caption");a.style.display="block",l.src=t,i.innerHTML=e}function ut(t,e,a){return[rt]}class dt extends t{constructor(t){super(),e(this,t,ut,ot,a,{changeImage:0})}get changeImage(){return rt}}function ct(t,e,a){const l=t.slice();return l[32]=e[a],l[34]=a,l}function gt(t,e,a){const l=t.slice();return l[35]=e[a],l[34]=a,l}function ft(t,e,a){const l=t.slice();return l[35]=e[a],l[34]=a,l}function ht(t,e,a){const l=t.slice();return l[38]=e[a],l[39]=e,l[40]=a,l}function mt(t){let e,a,p,v,w,E,k,b,S,$,T,V,x,N,_,M,L,j,B,C,P,R,F,A,U,K,q,z,W,J,G,Q,X,Y,Z,tt,et="configurations"in t[1]&&pt(t);return{c(){e=l("h4"),a=i("Scenario: "),p=i(t[3]),v=i(" Number of Containers: "),w=i(t[4]),E=i("."),k=g(),b=l("div"),S=l("div"),$=l("button"),T=i("Start Simulation"),V=g(),x=l("div"),N=l("button"),_=i("Stop Simulation"),M=g(),L=l("div"),j=l("button"),B=i("Reset WS Connection"),C=g(),P=l("hr"),R=g(),F=l("section"),A=l("h3"),U=i("Application Logs"),K=g(),q=l("button"),z=i("Clear Logs"),W=g(),et&&et.c(),J=g(),G=l("br"),Q=g(),X=l("hr"),this.h()},l(l){e=n(l,"H4",{});var i=o(e);a=s(i,"Scenario: "),p=s(i,t[3]),v=s(i," Number of Containers: "),w=s(i,t[4]),E=s(i,"."),i.forEach(r),k=f(l),b=n(l,"DIV",{class:!0});var u=o(b);S=n(u,"DIV",{class:!0});var d=o(S);$=n(d,"BUTTON",{class:!0});var c=o($);T=s(c,"Start Simulation"),c.forEach(r),d.forEach(r),V=f(u),x=n(u,"DIV",{class:!0});var g=o(x);N=n(g,"BUTTON",{class:!0});var h=o(N);_=s(h,"Stop Simulation"),h.forEach(r),g.forEach(r),M=f(u),L=n(u,"DIV",{class:!0});var m=o(L);j=n(m,"BUTTON",{class:!0});var y=o(j);B=s(y,"Reset WS Connection"),y.forEach(r),m.forEach(r),u.forEach(r),C=f(l),P=n(l,"HR",{class:!0}),R=f(l),F=n(l,"SECTION",{class:!0});var I=o(F);A=n(I,"H3",{});var D=o(A);U=s(D,"Application Logs"),D.forEach(r),I.forEach(r),K=f(l),q=n(l,"BUTTON",{class:!0});var O=o(q);z=s(O,"Clear Logs"),O.forEach(r),W=f(l),et&&et.l(l),J=f(l),G=n(l,"BR",{}),Q=f(l),X=n(l,"HR",{class:!0}),this.h()},h(){h($,"class","w3-col w3-input w3-border"),h(S,"class","w3-third"),h(N,"class","w3-col w3-input w3-border"),h(x,"class","w3-third"),h(j,"class","w3-col w3-input w3-border"),h(L,"class","w3-third"),h(b,"class","w3-row w3-section"),h(P,"class","svelte-drd2kv"),h(F,"class","page-headline"),h(q,"class","w3-col w3-input w3-border w3-button"),h(X,"class","svelte-drd2kv")},m(l,i){u(l,e,i),d(e,a),d(e,p),d(e,v),d(e,w),d(e,E),u(l,k,i),u(l,b,i),d(b,S),d(S,$),d($,T),d(b,V),d(b,x),d(x,N),d(N,_),d(b,M),d(b,L),d(L,j),d(j,B),u(l,C,i),u(l,P,i),u(l,R,i),u(l,F,i),d(F,A),d(A,U),u(l,K,i),u(l,q,i),d(q,z),u(l,W,i),et&&et.m(l,i),u(l,J,i),u(l,G,i),u(l,Q,i),u(l,X,i),Y=!0,Z||(tt=[m($,"click",t[15]),m(N,"click",t[16]),m(j,"click",t[17]),m(q,"click",t[8])],Z=!0)},p(t,e){(!Y||8&e[0])&&c(p,t[3]),(!Y||16&e[0])&&c(w,t[4]),"configurations"in t[1]?et?(et.p(t,e),2&e[0]&&y(et,1)):(et=pt(t),et.c(),y(et,1),et.m(J.parentNode,J)):et&&(H(),I(et,1,1,(()=>{et=null})),O())},i(t){Y||(y(et),Y=!0)},o(t){I(et),Y=!1},d(t){t&&r(e),t&&r(k),t&&r(b),t&&r(C),t&&r(P),t&&r(R),t&&r(F),t&&r(K),t&&r(q),t&&r(W),et&&et.d(t),t&&r(J),t&&r(G),t&&r(Q),t&&r(X),Z=!1,D(tt)}}}function pt(t){let e,a,l=t[1].configurations.length>0&&vt(t);return{c(){l&&l.c(),e=N()},l(t){l&&l.l(t),e=N()},m(t,i){l&&l.m(t,i),u(t,e,i),a=!0},p(t,a){t[1].configurations.length>0?l?(l.p(t,a),2&a[0]&&y(l,1)):(l=vt(t),l.c(),y(l,1),l.m(e.parentNode,e)):l&&(H(),I(l,1,1,(()=>{l=null})),O())},i(t){a||(y(l),a=!0)},o(t){I(l),a=!1},d(t){l&&l.d(t),t&&r(e)}}}function vt(t){let e,a,l=t[1].configurations,i=[];for(let o=0;o<l.length;o+=1)i[o]=bt(ht(t,l,o));const n=t=>I(i[t],1,1,(()=>{i[t]=null}));return{c(){for(let t=0;t<i.length;t+=1)i[t].c();e=N()},l(t){for(let e=0;e<i.length;e+=1)i[e].l(t);e=N()},m(t,l){for(let e=0;e<i.length;e+=1)i[e].m(t,l);u(t,e,l),a=!0},p(t,a){if(34&a[0]){let o;for(l=t[1].configurations,o=0;o<l.length;o+=1){const n=ht(t,l,o);i[o]?(i[o].p(n,a),y(i[o],1)):(i[o]=bt(n),i[o].c(),y(i[o],1),i[o].m(e.parentNode,e))}for(H(),o=l.length;o<i.length;o+=1)n(o);O()}},i(t){if(!a){for(let t=0;t<l.length;t+=1)y(i[t]);a=!0}},o(t){i=i.filter(Boolean);for(let e=0;e<i.length;e+=1)I(i[e]);a=!1},d(t){_(i,t),t&&r(e)}}}function wt(t){let e,a,l=t[40].toString()in t[5],i=l&&Et(t);return{c(){i&&i.c(),e=N()},l(t){i&&i.l(t),e=N()},m(t,l){i&&i.m(t,l),u(t,e,l),a=!0},p(t,a){32&a[0]&&(l=t[40].toString()in t[5]),l?i?(i.p(t,a),32&a[0]&&y(i,1)):(i=Et(t),i.c(),y(i,1),i.m(e.parentNode,e)):i&&(H(),I(i,1,1,(()=>{i=null})),O())},i(t){a||(y(i),a=!0)},o(t){I(i),a=!1},d(t){i&&i.d(t),t&&r(e)}}}function Et(t){let e,a,l=t[5][t[40].toString()].length>0,i=l&&kt(t);return{c(){i&&i.c(),e=N()},l(t){i&&i.l(t),e=N()},m(t,l){i&&i.m(t,l),u(t,e,l),a=!0},p(t,a){32&a[0]&&(l=t[5][t[40].toString()].length>0),l?i?(i.p(t,a),32&a[0]&&y(i,1)):(i=kt(t),i.c(),y(i,1),i.m(e.parentNode,e)):i&&(H(),I(i,1,1,(()=>{i=null})),O())},i(t){a||(y(i),a=!0)},o(t){I(i),a=!1},d(t){i&&i.d(t),t&&r(e)}}}function kt(t){let e,a,h,m,p,D,T=t[38].container_info.name+"";function V(e){t[18](e,t[40])}let x={title:t[38].container_info.name,headers:Object.keys(t[5][t[40].toString()][0])};return void 0!==t[5][t[40].toString()]&&(x.data=t[5][t[40].toString()]),m=new j({props:x}),v.push((()=>w(m,"data",V))),{c(){e=l("h5"),a=i(T),h=g(),E(m.$$.fragment)},l(t){e=n(t,"H5",{});var l=o(e);a=s(l,T),l.forEach(r),h=f(t),k(m.$$.fragment,t)},m(t,l){u(t,e,l),d(e,a),u(t,h,l),b(m,t,l),D=!0},p(e,l){t=e,(!D||2&l[0])&&T!==(T=t[38].container_info.name+"")&&c(a,T);const i={};2&l[0]&&(i.title=t[38].container_info.name),32&l[0]&&(i.headers=Object.keys(t[5][t[40].toString()][0])),!p&&32&l[0]&&(p=!0,i.data=t[5][t[40].toString()],S((()=>p=!1))),m.$set(i)},i(t){D||(y(m.$$.fragment,t),D=!0)},o(t){I(m.$$.fragment,t),D=!1},d(t){t&&r(e),t&&r(h),$(m,t)}}}function bt(t){let e,a,l=Object.keys(t[5]).length>0,i=l&&wt(t);return{c(){i&&i.c(),e=N()},l(t){i&&i.l(t),e=N()},m(t,l){i&&i.m(t,l),u(t,e,l),a=!0},p(t,a){32&a[0]&&(l=Object.keys(t[5]).length>0),l?i?(i.p(t,a),32&a[0]&&y(i,1)):(i=wt(t),i.c(),y(i,1),i.m(e.parentNode,e)):i&&(H(),I(i,1,1,(()=>{i=null})),O())},i(t){a||(y(i),a=!0)},o(t){I(i),a=!1},d(t){i&&i.d(t),t&&r(e)}}}function St(t){let e,a,c,p,v,w,E,k,b,S,y,I,$,T,V,x,N,O,_,L,H,j,B,C=t[6].length>0&&yt(t);return{c(){e=l("div"),a=l("div"),c=l("button"),p=i("Start Simulation"),v=g(),w=l("hr"),E=g(),k=l("div"),b=l("h1"),S=l("b"),y=i("Edit Files"),I=g(),C&&C.c(),$=g(),T=l("hr"),V=g(),x=l("div"),N=l("div"),O=l("button"),_=i("Delete Files"),L=g(),H=l("hr"),this.h()},l(t){e=n(t,"DIV",{class:!0});var l=o(e);a=n(l,"DIV",{class:!0});var i=o(a);c=n(i,"BUTTON",{class:!0});var u=o(c);p=s(u,"Start Simulation"),u.forEach(r),i.forEach(r),l.forEach(r),v=f(t),w=n(t,"HR",{class:!0}),E=f(t),k=n(t,"DIV",{class:!0});var d=o(k);b=n(d,"H1",{class:!0,style:!0});var g=o(b);S=n(g,"B",{});var h=o(S);y=s(h,"Edit Files"),h.forEach(r),g.forEach(r),d.forEach(r),I=f(t),C&&C.l(t),$=f(t),T=n(t,"HR",{class:!0}),V=f(t),x=n(t,"DIV",{class:!0});var m=o(x);N=n(m,"DIV",{class:!0});var D=o(N);O=n(D,"BUTTON",{class:!0});var M=o(O);_=s(M,"Delete Files"),M.forEach(r),D.forEach(r),m.forEach(r),L=f(t),H=n(t,"HR",{class:!0}),this.h()},h(){h(c,"class","w3-col w3-input w3-border"),h(a,"class","w3-rest"),h(e,"class","w3-row w3-section"),h(w,"class","svelte-drd2kv"),h(b,"class","w3-text-yellow"),M(b,"text-shadow","1px 1px 0 #444"),h(k,"class","w3-panel w3-blue"),h(T,"class","svelte-drd2kv"),h(O,"class","w3-col w3-input w3-border"),h(N,"class","w3-rest"),h(x,"class","w3-row w3-section"),h(H,"class","svelte-drd2kv")},m(l,i){u(l,e,i),d(e,a),d(a,c),d(c,p),u(l,v,i),u(l,w,i),u(l,E,i),u(l,k,i),d(k,b),d(b,S),d(S,y),u(l,I,i),C&&C.m(l,i),u(l,$,i),u(l,T,i),u(l,V,i),u(l,x,i),d(x,N),d(N,O),d(O,_),u(l,L,i),u(l,H,i),j||(B=[m(c,"click",t[11]),m(O,"click",t[12])],j=!0)},p(t,e){t[6].length>0?C?C.p(t,e):(C=yt(t),C.c(),C.m($.parentNode,$)):C&&(C.d(1),C=null)},d(t){t&&r(e),t&&r(v),t&&r(w),t&&r(E),t&&r(k),t&&r(I),C&&C.d(t),t&&r($),t&&r(T),t&&r(V),t&&r(x),t&&r(L),t&&r(H),j=!1,D(B)}}}function yt(t){let e,a,i,s,c,m,p=Object.keys(t[6][0]),v=[];for(let l=0;l<p.length;l+=1)v[l]=It(ft(t,p,l));let w=t[6],E=[];for(let l=0;l<w.length;l+=1)E[l]=Vt(ct(t,w,l));return{c(){e=l("div"),a=l("div"),i=l("table"),s=l("thead"),c=l("tr");for(let t=0;t<v.length;t+=1)v[t].c();m=g();for(let t=0;t<E.length;t+=1)E[t].c();this.h()},l(t){e=n(t,"DIV",{class:!0});var l=o(e);a=n(l,"DIV",{class:!0});var u=o(a);i=n(u,"TABLE",{class:!0,style:!0});var d=o(i);s=n(d,"THEAD",{});var g=o(s);c=n(g,"TR",{class:!0});var h=o(c);for(let e=0;e<v.length;e+=1)v[e].l(h);h.forEach(r),g.forEach(r),m=f(d);for(let e=0;e<E.length;e+=1)E[e].l(d);d.forEach(r),u.forEach(r),l.forEach(r),this.h()},h(){h(c,"class","w3-dark-grey"),h(i,"class","w3-table-all"),M(i,"width","100%"),h(a,"class","w3-responsive"),h(e,"class","w3-container")},m(t,l){u(t,e,l),d(e,a),d(a,i),d(i,s),d(s,c);for(let e=0;e<v.length;e+=1)v[e].m(c,null);d(i,m);for(let e=0;e<E.length;e+=1)E[e].m(i,null)},p(t,e){if(64&e[0]){let a;for(p=Object.keys(t[6][0]),a=0;a<p.length;a+=1){const l=ft(t,p,a);v[a]?v[a].p(l,e):(v[a]=It(l),v[a].c(),v[a].m(c,null))}for(;a<v.length;a+=1)v[a].d(1);v.length=p.length}if(8256&e[0]){let a;for(w=t[6],a=0;a<w.length;a+=1){const l=ct(t,w,a);E[a]?E[a].p(l,e):(E[a]=Vt(l),E[a].c(),E[a].m(i,null))}for(;a<E.length;a+=1)E[a].d(1);E.length=w.length}},d(t){t&&r(e),_(v,t),_(E,t)}}}function It(t){let e,a,g=t[35]+"";return{c(){e=l("th"),a=i(g)},l(t){e=n(t,"TH",{});var l=o(e);a=s(l,g),l.forEach(r)},m(t,l){u(t,e,l),d(e,a)},p(t,e){64&e[0]&&g!==(g=t[35]+"")&&c(a,g)},d(t){t&&r(e)}}}function $t(t){let e,a,g=t[32][t[35]]+"";return{c(){e=l("td"),a=i(g)},l(t){e=n(t,"TD",{});var l=o(e);a=s(l,g),l.forEach(r)},m(t,l){u(t,e,l),d(e,a)},p(t,e){64&e[0]&&g!==(g=t[32][t[35]]+"")&&c(a,g)},d(t){t&&r(e)}}}function Dt(t){let e,a,g,f,h=t[32][t[35]]+"";return{c(){e=l("td"),a=i(h)},l(t){e=n(t,"TD",{});var l=o(e);a=s(l,h),l.forEach(r)},m(l,i){u(l,e,i),d(e,a),g||(f=m(e,"click",t[13]),g=!0)},p(t,e){64&e[0]&&h!==(h=t[32][t[35]]+"")&&c(a,h)},d(t){t&&r(e),g=!1,f()}}}function Tt(t){let e;function a(t,e){return"filename"==t[35]?Dt:$t}let l=a(t),i=l(t);return{c(){i.c(),e=N()},l(t){i.l(t),e=N()},m(t,a){i.m(t,a),u(t,e,a)},p(t,n){l===(l=a(t))&&i?i.p(t,n):(i.d(1),i=l(t),i&&(i.c(),i.m(e.parentNode,e)))},d(t){i.d(t),t&&r(e)}}}function Vt(t){let e,a,i=Object.keys(t[6][0]),s=[];for(let l=0;l<i.length;l+=1)s[l]=Tt(gt(t,i,l));return{c(){e=l("tr");for(let t=0;t<s.length;t+=1)s[t].c();a=g()},l(t){e=n(t,"TR",{});var l=o(e);for(let e=0;e<s.length;e+=1)s[e].l(l);a=f(l),l.forEach(r)},m(t,l){u(t,e,l);for(let a=0;a<s.length;a+=1)s[a].m(e,null);d(e,a)},p(t,l){if(8256&l[0]){let n;for(i=Object.keys(t[6][0]),n=0;n<i.length;n+=1){const o=gt(t,i,n);s[n]?s[n].p(o,l):(s[n]=Tt(o),s[n].c(),s[n].m(e,a))}for(;n<s.length;n+=1)s[n].d(1);s.length=i.length}},d(t){t&&r(e),_(s,t)}}}function xt(t){let e,a,i,o,s;function d(e){t[19](e)}let c={title:"AutoPilot Component"};return void 0!==t[7]&&(c.input_data=t[7]),e=new nt({props:c}),v.push((()=>w(e,"input_data",d))),{c(){E(e.$$.fragment),i=g(),o=l("hr"),this.h()},l(t){k(e.$$.fragment,t),i=f(t),o=n(t,"HR",{class:!0}),this.h()},h(){h(o,"class","svelte-drd2kv")},m(t,a){b(e,t,a),u(t,i,a),u(t,o,a),s=!0},p(t,l){const i={};!a&&128&l[0]&&(a=!0,i.input_data=t[7],S((()=>a=!1))),e.$set(i)},i(t){s||(y(e.$$.fragment,t),s=!0)},o(t){I(e.$$.fragment,t),s=!1},d(t){$(e,t),t&&r(i),t&&r(o)}}}function Nt(t){let e,a,c,m,p,v,w,S,D,T,V,x,N,_,j,C,P,R,F;a=new B({});m=new dt({props:{}}),t[14](m);let A="Communication"==t[2]&&mt(t),U="Static"==t[2]&&St(t),K="Driving Simulation"==t[2]&&xt(t);return{c(){e=g(),E(a.$$.fragment),c=g(),E(m.$$.fragment),p=g(),v=l("hr"),w=g(),S=l("div"),D=l("h1"),T=l("b"),V=i("Simulation"),x=g(),N=l("hr"),_=g(),A&&A.c(),j=g(),U&&U.c(),C=g(),K&&K.c(),P=g(),R=l("hr"),this.h()},l(t){L('[data-svelte="svelte-1smsifb"]',document.head).forEach(r),e=f(t),k(a.$$.fragment,t),c=f(t),k(m.$$.fragment,t),p=f(t),v=n(t,"HR",{class:!0}),w=f(t),S=n(t,"DIV",{class:!0});var l=o(S);D=n(l,"H1",{class:!0,style:!0});var i=o(D);T=n(i,"B",{});var u=o(T);V=s(u,"Simulation"),u.forEach(r),i.forEach(r),l.forEach(r),x=f(t),N=n(t,"HR",{class:!0}),_=f(t),A&&A.l(t),j=f(t),U&&U.l(t),C=f(t),K&&K.l(t),P=f(t),R=n(t,"HR",{class:!0}),this.h()},h(){document.title="Simulation",h(v,"class","svelte-drd2kv"),h(D,"class","w3-text-yellow"),M(D,"text-shadow","1px 1px 0 #444"),h(S,"class","w3-panel w3-blue"),h(N,"class","svelte-drd2kv"),h(R,"class","svelte-drd2kv")},m(t,l){u(t,e,l),b(a,t,l),u(t,c,l),b(m,t,l),u(t,p,l),u(t,v,l),u(t,w,l),u(t,S,l),d(S,D),d(D,T),d(T,V),u(t,x,l),u(t,N,l),u(t,_,l),A&&A.m(t,l),u(t,j,l),U&&U.m(t,l),u(t,C,l),K&&K.m(t,l),u(t,P,l),u(t,R,l),F=!0},p(t,e){m.$set({}),"Communication"==t[2]?A?(A.p(t,e),4&e[0]&&y(A,1)):(A=mt(t),A.c(),y(A,1),A.m(j.parentNode,j)):A&&(H(),I(A,1,1,(()=>{A=null})),O()),"Static"==t[2]?U?U.p(t,e):(U=St(t),U.c(),U.m(C.parentNode,C)):U&&(U.d(1),U=null),"Driving Simulation"==t[2]?K?(K.p(t,e),4&e[0]&&y(K,1)):(K=xt(t),K.c(),y(K,1),K.m(P.parentNode,P)):K&&(H(),I(K,1,1,(()=>{K=null})),O())},i(t){F||(y(a.$$.fragment,t),y(m.$$.fragment,t),y(A),y(K),F=!0)},o(t){I(a.$$.fragment,t),I(m.$$.fragment,t),I(A),I(K),F=!1},d(l){l&&r(e),$(a,l),l&&r(c),t[14](null),$(m,l),l&&r(p),l&&r(v),l&&r(w),l&&r(S),l&&r(x),l&&r(N),l&&r(_),A&&A.d(l),l&&r(j),U&&U.d(l),l&&r(C),K&&K.d(l),l&&r(P),l&&r(R)}}}function Ot(t,e,a){let l,i=[],n={},o="";const s=U.subscribe((t=>{i=t})),r=A.subscribe((t=>{a(1,n=t)})),u=K.subscribe((t=>{a(2,o=t)}));let d=[],c=[];T((()=>{s(),r(),u();for(let t=0;t<d.length;t++)d[t].close();for(let t=0;t<c.length;t++)c[t].close()}));let g="Please create and select a scenario before starting the simulation.",f=!1,h=0,m=[],p={},w=[],E=[];function k(){for(const[t,e]of Object.entries(p))a(5,p[t]=[],p)}async function b(t){if(!f)return void C.danger("please create and activate a scenario first.");"start"==t&&k(),R("/simulation/comm","POST",{command:t,configs:n},(function(t){t.data&&(C.success("simulation started."),console.log("response of simulation",t.data))}))}function S(){for(var t=0;t<d.length;t++)ws=d[t],ws.close()}V((async()=>{console.log("scenarios",i,"scenario_configurations",n,"scenario_type",o);let t="";for(let e=0;e<i.length;e++)i[e].activated&&(a(3,g=i[e].name),f=!0,t="/api/db1/scenario_configurations/ref-"+i[e]._id);!function(t,e){P(t,(function(t){let a=JSON.parse(t.response);a.data&&a.data.length>0&&(A.set(a.data[0]),e())}))}(t,(function(){if("Communication"==n.type){"configurations"in n&&a(4,h=n.configurations.length);for(var t=0;t<h;t++){a(5,p[t.toString()]=[],p);let e="ws://localhost:8000/simulation/comm/ws/"+t.toString(),l=new WebSocket(e);l.onopen=function(){window.console.log("Successfully connected to the echo websocket server...")},l.onmessage=function(t){let e=JSON.parse(t.data);console.log(e,"printing JSON now");let l=e.client_index,i=JSON.parse(e.data);"status"in i?m[l]=i.status:a(5,p[l]=[...p[l],i],p)},d.push(l)}}if("Static"==n.type){console.log("hello static sample");let t=new WebSocket("ws://localhost:8000/simulation/static/ws");t.onopen=function(){window.console.log("static simulation websocket")},t.onmessage=function(t){let e=JSON.parse(t.data);a(6,w=[...w,e])},c.push(t)}"Communication"==n.type&&console.log("hello driving scenario")}))}));return[l,n,o,g,h,p,w,E,k,b,S,function(){R("/simulation/static","POST",{configs:n},(function(t){t.data&&(C.success("simulation started."),console.log("response of simulation",t.data))}))},function(){R("/simulation/static","DELETE",{configs:n},(function(t){t.data&&(C.success("Delete successful."),a(6,w=[]),console.log("response of simulation",t.data))}))},function(){let t=this.innerText;F("/simulation/static","POST",{configs:n,filename:t},(function(e){if(e){let a=new Blob([e.response],{type:"octet/stream"}),i=(window.URL||window.webkitURL).createObjectURL(a);l.changeImage(i,t)}}))},function(t){v[t?"unshift":"push"]((()=>{l=t,a(0,l)}))},()=>b("start"),()=>b("stop"),()=>S(),function(e,l){t.$$.not_equal(p[l.toString()],e)&&(p[l.toString()]=e,a(5,p))},function(t){E=t,a(7,E)}]}export default class extends t{constructor(t){super(),e(this,t,Ot,Nt,a,{},[-1,-1])}}
