import{S as t,i as s,s as a,l as n,f as o,v as e,t as r,g as l,j as c,k as i,m as f,n as u,o as g,a5 as d,r as h,w as m,d as p,u as w,M as v,e as S,L as b,c as k,a as $,b as E,N,F as O,G as j,h as T,Q as y,R as x,z as _,B,a3 as H,a4 as R}from"../../chunks/vendor-5cf7a4b5.js";import{T as C}from"../../chunks/index-a1695e4a.js";import{T as D,n as I,a as L}from"../../chunks/requests-f597ce78.js";import{s as V,a as J}from"../../chunks/store-f8ef346b.js";function U(t,s,a){const n=t.slice();return n[17]=s[a],n[18]=s,n[19]=a,n}function q(t){let s,a,r=t[0].configurations.length>0&&A(t);return{c(){r&&r.c(),s=n()},l(t){r&&r.l(t),s=n()},m(t,n){r&&r.m(t,n),o(t,s,n),a=!0},p(t,a){t[0].configurations.length>0?r?(r.p(t,a),1&a&&e(r,1)):(r=A(t),r.c(),e(r,1),r.m(s.parentNode,s)):r&&(B(),h(r,1,1,(()=>{r=null})),w())},i(t){a||(e(r),a=!0)},o(t){h(r),a=!1},d(t){r&&r.d(t),t&&p(s)}}}function A(t){let s,a,r=t[0].configurations,l=[];for(let n=0;n<r.length;n+=1)l[n]=z(U(t,r,n));const c=t=>h(l[t],1,1,(()=>{l[t]=null}));return{c(){for(let t=0;t<l.length;t+=1)l[t].c();s=n()},l(t){for(let s=0;s<l.length;s+=1)l[s].l(t);s=n()},m(t,n){for(let s=0;s<l.length;s+=1)l[s].m(t,n);o(t,s,n),a=!0},p(t,a){if(9&a){let n;for(r=t[0].configurations,n=0;n<r.length;n+=1){const o=U(t,r,n);l[n]?(l[n].p(o,a),e(l[n],1)):(l[n]=z(o),l[n].c(),e(l[n],1),l[n].m(s.parentNode,s))}for(B(),n=r.length;n<l.length;n+=1)c(n);w()}},i(t){if(!a){for(let t=0;t<r.length;t+=1)e(l[t]);a=!0}},o(t){l=l.filter(Boolean);for(let s=0;s<l.length;s+=1)h(l[s]);a=!1},d(t){v(l,t),t&&p(s)}}}function P(t){let s,a,n,r;function l(s){t[8](s,t[19])}let w={title:t[17].container_info.name,headers:Object.keys(t[3][t[19].toString()])};return void 0!==t[3][t[19].toString()]&&(w.data=t[3][t[19].toString()]),s=new C({props:w}),H.push((()=>R(s,"data",l))),{c(){c(s.$$.fragment),n=i()},l(t){f(s.$$.fragment,t),n=u(t)},m(t,a){g(s,t,a),o(t,n,a),r=!0},p(n,o){t=n;const e={};1&o&&(e.title=t[17].container_info.name),8&o&&(e.headers=Object.keys(t[3][t[19].toString()])),!a&&8&o&&(a=!0,e.data=t[3][t[19].toString()],d((()=>a=!1))),s.$set(e)},i(t){r||(e(s.$$.fragment,t),r=!0)},o(t){h(s.$$.fragment,t),r=!1},d(t){m(s,t),t&&p(n)}}}function z(t){let s,a,c,i=Object.keys(t[3]).length>0,f=i&&P(t);return{c(){s=r("iteration works\n\n\t\t\t"),f&&f.c(),a=n()},l(t){s=l(t,"iteration works\n\n\t\t\t"),f&&f.l(t),a=n()},m(t,n){o(t,s,n),f&&f.m(t,n),o(t,a,n),c=!0},p(t,s){8&s&&(i=Object.keys(t[3]).length>0),i?f?(f.p(t,s),8&s&&e(f,1)):(f=P(t),f.c(),e(f,1),f.m(a.parentNode,a)):f&&(B(),h(f,1,1,(()=>{f=null})),w())},i(t){c||(e(f),c=!0)},o(t){h(f),c=!1},d(t){t&&p(s),f&&f.d(t),t&&p(a)}}}function F(t){let s,a,n,d,v,x,_,H,R,C,I,L,V,J,U,A,P,z,F,G,M,Q,W,K,X,Y,Z,tt,st,at,nt,ot,et,rt,lt,ct,it,ft,ut,gt,dt,ht,mt,pt;a=new D({});let wt="configurations"in t[0]&&q(t);return{c(){s=i(),c(a.$$.fragment),n=i(),d=S("hr"),v=i(),x=S("div"),_=S("h1"),H=S("b"),R=r("Simulation"),C=i(),I=S("hr"),L=i(),V=S("h4"),J=r("Scenario: "),U=r(t[1]),A=r(" Number of Containers: "),P=r(t[2]),z=r("."),F=i(),G=S("div"),M=S("div"),Q=S("button"),W=r("Start Simulation"),K=i(),X=S("div"),Y=S("button"),Z=r("Stop Simulation"),tt=i(),st=S("hr"),at=i(),nt=S("section"),ot=S("h3"),et=r("Application Logs"),rt=i(),lt=S("button"),ct=r("Clear Logs"),it=i(),wt&&wt.c(),ft=i(),ut=S("br"),gt=i(),dt=S("hr"),this.h()},l(o){b('[data-svelte="svelte-1smsifb"]',document.head).forEach(p),s=u(o),f(a.$$.fragment,o),n=u(o),d=k(o,"HR",{class:!0}),v=u(o),x=k(o,"DIV",{class:!0});var e=$(x);_=k(e,"H1",{class:!0,style:!0});var r=$(_);H=k(r,"B",{});var c=$(H);R=l(c,"Simulation"),c.forEach(p),r.forEach(p),e.forEach(p),C=u(o),I=k(o,"HR",{class:!0}),L=u(o),V=k(o,"H4",{});var i=$(V);J=l(i,"Scenario: "),U=l(i,t[1]),A=l(i," Number of Containers: "),P=l(i,t[2]),z=l(i,"."),i.forEach(p),F=u(o),G=k(o,"DIV",{class:!0});var g=$(G);M=k(g,"DIV",{class:!0});var h=$(M);Q=k(h,"BUTTON",{class:!0});var m=$(Q);W=l(m,"Start Simulation"),m.forEach(p),h.forEach(p),K=u(g),X=k(g,"DIV",{class:!0});var w=$(X);Y=k(w,"BUTTON",{class:!0});var S=$(Y);Z=l(S,"Stop Simulation"),S.forEach(p),w.forEach(p),g.forEach(p),tt=u(o),st=k(o,"HR",{class:!0}),at=u(o),nt=k(o,"SECTION",{class:!0});var E=$(nt);ot=k(E,"H3",{});var N=$(ot);et=l(N,"Application Logs"),N.forEach(p),E.forEach(p),rt=u(o),lt=k(o,"BUTTON",{class:!0});var O=$(lt);ct=l(O,"Clear Logs"),O.forEach(p),it=u(o),wt&&wt.l(o),ft=u(o),ut=k(o,"BR",{}),gt=u(o),dt=k(o,"HR",{class:!0}),this.h()},h(){document.title="Simulation",E(d,"class","svelte-drd2kv"),E(_,"class","w3-text-yellow"),N(_,"text-shadow","1px 1px 0 #444"),E(x,"class","w3-panel w3-blue"),E(I,"class","svelte-drd2kv"),E(Q,"class","w3-col w3-input w3-border w3-margin"),E(M,"class","w3-half"),E(Y,"class","w3-col w3-input w3-border w3-margin"),E(X,"class","w3-half"),E(G,"class","w3-row w3-section"),E(st,"class","svelte-drd2kv"),E(nt,"class","page-headline"),E(lt,"class","w3-col w3-input w3-border w3-button"),E(dt,"class","svelte-drd2kv")},m(e,r){o(e,s,r),g(a,e,r),o(e,n,r),o(e,d,r),o(e,v,r),o(e,x,r),O(x,_),O(_,H),O(H,R),o(e,C,r),o(e,I,r),o(e,L,r),o(e,V,r),O(V,J),O(V,U),O(V,A),O(V,P),O(V,z),o(e,F,r),o(e,G,r),O(G,M),O(M,Q),O(Q,W),O(G,K),O(G,X),O(X,Y),O(Y,Z),o(e,tt,r),o(e,st,r),o(e,at,r),o(e,nt,r),O(nt,ot),O(ot,et),o(e,rt,r),o(e,lt,r),O(lt,ct),o(e,it,r),wt&&wt.m(e,r),o(e,ft,r),o(e,ut,r),o(e,gt,r),o(e,dt,r),ht=!0,mt||(pt=[j(Q,"click",t[6]),j(Y,"click",t[7]),j(lt,"click",t[4])],mt=!0)},p(t,[s]){(!ht||2&s)&&T(U,t[1]),(!ht||4&s)&&T(P,t[2]),"configurations"in t[0]?wt?(wt.p(t,s),1&s&&e(wt,1)):(wt=q(t),wt.c(),e(wt,1),wt.m(ft.parentNode,ft)):wt&&(B(),h(wt,1,1,(()=>{wt=null})),w())},i(t){ht||(e(a.$$.fragment,t),e(wt),ht=!0)},o(t){h(a.$$.fragment,t),h(wt),ht=!1},d(t){t&&p(s),m(a,t),t&&p(n),t&&p(d),t&&p(v),t&&p(x),t&&p(C),t&&p(I),t&&p(L),t&&p(V),t&&p(F),t&&p(G),t&&p(tt),t&&p(st),t&&p(at),t&&p(nt),t&&p(rt),t&&p(lt),t&&p(it),wt&&wt.d(t),t&&p(ft),t&&p(ut),t&&p(gt),t&&p(dt),mt=!1,y(pt)}}}function G(t,s,a){let n=[],o={};const e=V.subscribe((t=>{n=t})),r=J.subscribe((t=>{a(0,o=t)}));let l=[];x((()=>{e(),r();for(let t=0;t<l.length;t++)l[t].close()}));let c="Please create and select a scenario before starting the simulation.",i=!1,f=0,u=[],g={};function d(){for(const[t,s]of Object.entries(g))a(3,g[t]=[],g)}async function h(t){if(!i)return void I.danger("please create and activate a scenario first.");d(),console.log("start or stop simulation"),L("/simulation","POST",{command:t,configs:o},(function(t){t.data&&console.log("response of start simulation",t.data)}))}_((async()=>{for(let s=0;s<n.length;s++)n[s].activated&&(a(1,c=n[s].name),i=!0);"configurations"in o&&a(2,f=o.configurations.length),console.log("scenarios",n),console.log("scenario_configurations",o),l=[];for(var t=0;t<f;t++){a(3,g[t.toString()]=[],g);let s="ws://localhost:8000/simulation/ws/"+o.configurations[t].container_info.name+"/"+o.configurations[t].container_info.ports.split(",")[0].split("/")[0]+"/"+t.toString();console.log("ws url:",s);let n=new WebSocket(s);n.onopen=function(){window.console.log("Successfully connected to the echo websocket server...")},n.onmessage=function(t){window.console.log(t,"received ws message");let s=JSON.parse(t.data);console.log(s,"printing JSON now");let n=s.client_index,o=JSON.parse(s.data);a(3,g[n]=[...g[n],o],g),console.log("containerData",o),"status"in o&&(u[n]=o.status),console.log(g,"ws_data printing")},l.push(n)}}));return[o,c,f,g,d,h,()=>h("start"),()=>h("stop"),function(s,n){t.$$.not_equal(g[n.toString()],s)&&(g[n.toString()]=s,a(3,g))}]}export default class extends t{constructor(t){super(),s(this,t,G,F,a,{})}}
