import{S as t,i as a,s,e,t as n,k as o,c as l,a as c,g as r,d as i,n as h,b as f,f as u,F as d,G as m,h as v,v as p,l as g,j as w,m as E,o as S,a6 as b,r as T,w as k,u as N,M as D,Q as x,N as O,H as y,L as I,R as V,z as $,B as H,a4 as B,a5 as R}from"../../chunks/vendor-c052606d.js";import{T as j}from"../../chunks/index-e04611e2.js";import{T as C,x as U,n as F,a as _}from"../../chunks/requests-531e903b.js";import{s as A,a as L,b as P}from"../../chunks/store-ce76cd4a.js";/* empty css                                                       */function J(t,a,s){const e=t.slice();return e[26]=a[s],e[28]=s,e}function G(t,a,s){const e=t.slice();return e[29]=a[s],e[30]=a,e[31]=s,e}function W(t){let a,s,g,w,E,S,b,k,D,O,y,I,V,$,B,R,j,C,U,F,_,A,L,P,J,G,W,z,M,Q,K,X,Y,Z,tt,at,st="configurations"in t[0]&&q(t);return{c(){a=e("h4"),s=n("Scenario: "),g=n(t[2]),w=n(" Number of Containers: "),E=n(t[3]),S=n("."),b=o(),k=e("div"),D=e("div"),O=e("button"),y=n("Start Simulation"),I=o(),V=e("div"),$=e("button"),B=n("Stop Simulation"),R=o(),j=e("div"),C=e("button"),U=n("Reset WS Connection"),F=o(),_=e("hr"),A=o(),L=e("section"),P=e("h3"),J=n("Application Logs"),G=o(),W=e("button"),z=n("Clear Logs"),M=o(),st&&st.c(),Q=o(),K=e("br"),X=o(),Y=e("hr"),this.h()},l(e){a=l(e,"H4",{});var n=c(a);s=r(n,"Scenario: "),g=r(n,t[2]),w=r(n," Number of Containers: "),E=r(n,t[3]),S=r(n,"."),n.forEach(i),b=h(e),k=l(e,"DIV",{class:!0});var o=c(k);D=l(o,"DIV",{class:!0});var f=c(D);O=l(f,"BUTTON",{class:!0});var u=c(O);y=r(u,"Start Simulation"),u.forEach(i),f.forEach(i),I=h(o),V=l(o,"DIV",{class:!0});var d=c(V);$=l(d,"BUTTON",{class:!0});var m=c($);B=r(m,"Stop Simulation"),m.forEach(i),d.forEach(i),R=h(o),j=l(o,"DIV",{class:!0});var v=c(j);C=l(v,"BUTTON",{class:!0});var p=c(C);U=r(p,"Reset WS Connection"),p.forEach(i),v.forEach(i),o.forEach(i),F=h(e),_=l(e,"HR",{class:!0}),A=h(e),L=l(e,"SECTION",{class:!0});var T=c(L);P=l(T,"H3",{});var N=c(P);J=r(N,"Application Logs"),N.forEach(i),T.forEach(i),G=h(e),W=l(e,"BUTTON",{class:!0});var x=c(W);z=r(x,"Clear Logs"),x.forEach(i),M=h(e),st&&st.l(e),Q=h(e),K=l(e,"BR",{}),X=h(e),Y=l(e,"HR",{class:!0}),this.h()},h(){f(O,"class","w3-col w3-input w3-border"),f(D,"class","w3-third"),f($,"class","w3-col w3-input w3-border"),f(V,"class","w3-third"),f(C,"class","w3-col w3-input w3-border"),f(j,"class","w3-third"),f(k,"class","w3-row w3-section"),f(_,"class","svelte-drd2kv"),f(L,"class","page-headline"),f(W,"class","w3-col w3-input w3-border w3-button"),f(Y,"class","svelte-drd2kv")},m(e,n){u(e,a,n),d(a,s),d(a,g),d(a,w),d(a,E),d(a,S),u(e,b,n),u(e,k,n),d(k,D),d(D,O),d(O,y),d(k,I),d(k,V),d(V,$),d($,B),d(k,R),d(k,j),d(j,C),d(C,U),u(e,F,n),u(e,_,n),u(e,A,n),u(e,L,n),d(L,P),d(P,J),u(e,G,n),u(e,W,n),d(W,z),u(e,M,n),st&&st.m(e,n),u(e,Q,n),u(e,K,n),u(e,X,n),u(e,Y,n),Z=!0,tt||(at=[m(O,"click",t[11]),m($,"click",t[12]),m(C,"click",t[13]),m(W,"click",t[6])],tt=!0)},p(t,a){(!Z||4&a[0])&&v(g,t[2]),(!Z||8&a[0])&&v(E,t[3]),"configurations"in t[0]?st?(st.p(t,a),1&a[0]&&p(st,1)):(st=q(t),st.c(),p(st,1),st.m(Q.parentNode,Q)):st&&(H(),T(st,1,1,(()=>{st=null})),N())},i(t){Z||(p(st),Z=!0)},o(t){T(st),Z=!1},d(t){t&&i(a),t&&i(b),t&&i(k),t&&i(F),t&&i(_),t&&i(A),t&&i(L),t&&i(G),t&&i(W),t&&i(M),st&&st.d(t),t&&i(Q),t&&i(K),t&&i(X),t&&i(Y),tt=!1,x(at)}}}function q(t){let a,s,e=t[0].configurations.length>0&&z(t);return{c(){e&&e.c(),a=g()},l(t){e&&e.l(t),a=g()},m(t,n){e&&e.m(t,n),u(t,a,n),s=!0},p(t,s){t[0].configurations.length>0?e?(e.p(t,s),1&s[0]&&p(e,1)):(e=z(t),e.c(),p(e,1),e.m(a.parentNode,a)):e&&(H(),T(e,1,1,(()=>{e=null})),N())},i(t){s||(p(e),s=!0)},o(t){T(e),s=!1},d(t){e&&e.d(t),t&&i(a)}}}function z(t){let a,s,e=t[0].configurations,n=[];for(let l=0;l<e.length;l+=1)n[l]=X(G(t,e,l));const o=t=>T(n[t],1,1,(()=>{n[t]=null}));return{c(){for(let t=0;t<n.length;t+=1)n[t].c();a=g()},l(t){for(let a=0;a<n.length;a+=1)n[a].l(t);a=g()},m(t,e){for(let a=0;a<n.length;a+=1)n[a].m(t,e);u(t,a,e),s=!0},p(t,s){if(17&s[0]){let l;for(e=t[0].configurations,l=0;l<e.length;l+=1){const o=G(t,e,l);n[l]?(n[l].p(o,s),p(n[l],1)):(n[l]=X(o),n[l].c(),p(n[l],1),n[l].m(a.parentNode,a))}for(H(),l=e.length;l<n.length;l+=1)o(l);N()}},i(t){if(!s){for(let t=0;t<e.length;t+=1)p(n[t]);s=!0}},o(t){n=n.filter(Boolean);for(let a=0;a<n.length;a+=1)T(n[a]);s=!1},d(t){D(n,t),t&&i(a)}}}function M(t){let a,s,e=t[31].toString()in t[4],n=e&&Q(t);return{c(){n&&n.c(),a=g()},l(t){n&&n.l(t),a=g()},m(t,e){n&&n.m(t,e),u(t,a,e),s=!0},p(t,s){16&s[0]&&(e=t[31].toString()in t[4]),e?n?(n.p(t,s),16&s[0]&&p(n,1)):(n=Q(t),n.c(),p(n,1),n.m(a.parentNode,a)):n&&(H(),T(n,1,1,(()=>{n=null})),N())},i(t){s||(p(n),s=!0)},o(t){T(n),s=!1},d(t){n&&n.d(t),t&&i(a)}}}function Q(t){let a,s,e=t[4][t[31].toString()].length>0,n=e&&K(t);return{c(){n&&n.c(),a=g()},l(t){n&&n.l(t),a=g()},m(t,e){n&&n.m(t,e),u(t,a,e),s=!0},p(t,s){16&s[0]&&(e=t[4][t[31].toString()].length>0),e?n?(n.p(t,s),16&s[0]&&p(n,1)):(n=K(t),n.c(),p(n,1),n.m(a.parentNode,a)):n&&(H(),T(n,1,1,(()=>{n=null})),N())},i(t){s||(p(n),s=!0)},o(t){T(n),s=!1},d(t){n&&n.d(t),t&&i(a)}}}function K(t){let a,s,f,m,g,N,D=t[29].container_info.name+"";function x(a){t[14](a,t[31])}let O={title:t[29].container_info.name,headers:Object.keys(t[4][t[31].toString()][0])};return void 0!==t[4][t[31].toString()]&&(O.data=t[4][t[31].toString()]),m=new j({props:O}),B.push((()=>R(m,"data",x))),{c(){a=e("h5"),s=n(D),f=o(),w(m.$$.fragment)},l(t){a=l(t,"H5",{});var e=c(a);s=r(e,D),e.forEach(i),f=h(t),E(m.$$.fragment,t)},m(t,e){u(t,a,e),d(a,s),u(t,f,e),S(m,t,e),N=!0},p(a,e){t=a,(!N||1&e[0])&&D!==(D=t[29].container_info.name+"")&&v(s,D);const n={};1&e[0]&&(n.title=t[29].container_info.name),16&e[0]&&(n.headers=Object.keys(t[4][t[31].toString()][0])),!g&&16&e[0]&&(g=!0,n.data=t[4][t[31].toString()],b((()=>g=!1))),m.$set(n)},i(t){N||(p(m.$$.fragment,t),N=!0)},o(t){T(m.$$.fragment,t),N=!1},d(t){t&&i(a),t&&i(f),k(m,t)}}}function X(t){let a,s,e=Object.keys(t[4]).length>0,n=e&&M(t);return{c(){n&&n.c(),a=g()},l(t){n&&n.l(t),a=g()},m(t,e){n&&n.m(t,e),u(t,a,e),s=!0},p(t,s){16&s[0]&&(e=Object.keys(t[4]).length>0),e?n?(n.p(t,s),16&s[0]&&p(n,1)):(n=M(t),n.c(),p(n,1),n.m(a.parentNode,a)):n&&(H(),T(n,1,1,(()=>{n=null})),N())},i(t){s||(p(n),s=!0)},o(t){T(n),s=!1},d(t){n&&n.d(t),t&&i(a)}}}function Y(t){let a,s,v,p,g,w,E,S,b,T,k,N,y,I,V,$,H,B,R,j,C,U,F,_,A,L,P,G,W,q,z,M,Q,K,X,Y=t[5].length>0&&function(t){let a,s,m,v,p,g,w,E,S,b,T,k=t[5],N=[];for(let e=0;e<k.length;e+=1)N[e]=Z(J(t,k,e));return{c(){a=e("div"),s=e("div"),m=e("table"),v=e("thead"),p=e("tr"),g=e("th"),w=n("Filename"),E=o(),S=e("th"),b=n("Actions"),T=o();for(let t=0;t<N.length;t+=1)N[t].c();this.h()},l(t){a=l(t,"DIV",{class:!0});var e=c(a);s=l(e,"DIV",{class:!0});var n=c(s);m=l(n,"TABLE",{class:!0,style:!0});var o=c(m);v=l(o,"THEAD",{});var f=c(v);p=l(f,"TR",{class:!0});var u=c(p);g=l(u,"TH",{class:!0});var d=c(g);w=r(d,"Filename"),d.forEach(i),E=h(u),S=l(u,"TH",{class:!0});var k=c(S);b=r(k,"Actions"),k.forEach(i),u.forEach(i),f.forEach(i),T=h(o);for(let a=0;a<N.length;a+=1)N[a].l(o);o.forEach(i),n.forEach(i),e.forEach(i),this.h()},h(){f(g,"class","w3-left-align"),f(S,"class","w3-right-align"),f(p,"class","w3-dark-grey"),f(m,"class","w3-table-all"),O(m,"width","100%"),f(s,"class","w3-responsive"),f(a,"class","w3-container")},m(t,e){u(t,a,e),d(a,s),d(s,m),d(m,v),d(v,p),d(p,g),d(g,w),d(p,E),d(p,S),d(S,b),d(m,T);for(let a=0;a<N.length;a+=1)N[a].m(m,null)},p(t,a){if(32&a[0]){let s;for(k=t[5],s=0;s<k.length;s+=1){const e=J(t,k,s);N[s]?N[s].p(e,a):(N[s]=Z(e),N[s].c(),N[s].m(m,null))}for(;s<N.length;s+=1)N[s].d(1);N.length=k.length}},d(t){t&&i(a),D(N,t)}}}(t);return{c(){a=e("div"),s=e("div"),v=e("button"),p=n("Start Simulation"),g=o(),w=e("hr"),E=o(),S=e("div"),b=e("h1"),T=e("b"),k=n("Edit Files"),N=o(),Y&&Y.c(),y=o(),I=e("hr"),V=o(),$=e("div"),H=e("div"),B=e("input"),R=o(),j=e("div"),C=e("button"),U=n("Store Files"),F=o(),_=e("div"),A=e("button"),L=n("Export Files"),P=o(),G=e("hr"),W=o(),q=e("div"),z=e("h1"),M=e("b"),Q=n("Generated Datasets"),this.h()},l(t){a=l(t,"DIV",{class:!0});var e=c(a);s=l(e,"DIV",{class:!0});var n=c(s);v=l(n,"BUTTON",{class:!0});var o=c(v);p=r(o,"Start Simulation"),o.forEach(i),n.forEach(i),e.forEach(i),g=h(t),w=l(t,"HR",{class:!0}),E=h(t),S=l(t,"DIV",{class:!0});var f=c(S);b=l(f,"H1",{class:!0,style:!0});var u=c(b);T=l(u,"B",{});var d=c(T);k=r(d,"Edit Files"),d.forEach(i),u.forEach(i),f.forEach(i),N=h(t),Y&&Y.l(t),y=h(t),I=l(t,"HR",{class:!0}),V=h(t),$=l(t,"DIV",{class:!0});var m=c($);H=l(m,"DIV",{class:!0});var D=c(H);B=l(D,"INPUT",{id:!0,class:!0,name:!0,type:!0,placeholder:!0}),D.forEach(i),R=h(m),j=l(m,"DIV",{class:!0});var x=c(j);C=l(x,"BUTTON",{class:!0});var O=c(C);U=r(O,"Store Files"),O.forEach(i),x.forEach(i),F=h(m),_=l(m,"DIV",{class:!0});var J=c(_);A=l(J,"BUTTON",{class:!0});var K=c(A);L=r(K,"Export Files"),K.forEach(i),J.forEach(i),m.forEach(i),P=h(t),G=l(t,"HR",{class:!0}),W=h(t),q=l(t,"DIV",{class:!0});var X=c(q);z=l(X,"H1",{class:!0,style:!0});var Z=c(z);M=l(Z,"B",{});var tt=c(M);Q=r(tt,"Generated Datasets"),tt.forEach(i),Z.forEach(i),X.forEach(i),this.h()},h(){f(v,"class","w3-col w3-input w3-border"),f(s,"class","w3-rest"),f(a,"class","w3-row w3-section"),f(w,"class","svelte-drd2kv"),f(b,"class","w3-text-yellow"),O(b,"text-shadow","1px 1px 0 #444"),f(S,"class","w3-panel w3-blue"),f(I,"class","svelte-drd2kv"),f(B,"id","filename"),f(B,"class","w3-input w3-border"),f(B,"name","filename"),f(B,"type","text"),f(B,"placeholder","Filename"),f(H,"class","w3-rest"),f(C,"class","w3-col w3-input w3-border"),f(j,"class","w3-half"),f(A,"class","w3-col w3-input w3-border"),f(_,"class","w3-half"),f($,"class","w3-row w3-section"),f(G,"class","svelte-drd2kv"),f(z,"class","w3-text-yellow"),O(z,"text-shadow","1px 1px 0 #444"),f(q,"class","w3-panel w3-blue")},m(e,n){u(e,a,n),d(a,s),d(s,v),d(v,p),u(e,g,n),u(e,w,n),u(e,E,n),u(e,S,n),d(S,b),d(b,T),d(T,k),u(e,N,n),Y&&Y.m(e,n),u(e,y,n),u(e,I,n),u(e,V,n),u(e,$,n),d($,H),d(H,B),d($,R),d($,j),d(j,C),d(C,U),d($,F),d($,_),d(_,A),d(A,L),u(e,P,n),u(e,G,n),u(e,W,n),u(e,q,n),d(q,z),d(z,M),d(M,Q),K||(X=[m(v,"click",t[9]),m(C,"click",nt),m(A,"click",ot)],K=!0)},p(t,a){t[5].length>0&&Y.p(t,a)},d(t){t&&i(a),t&&i(g),t&&i(w),t&&i(E),t&&i(S),t&&i(N),Y&&Y.d(t),t&&i(y),t&&i(I),t&&i(V),t&&i($),t&&i(P),t&&i(G),t&&i(W),t&&i(q),K=!1,x(X)}}}function Z(t){let a,s,v,p,g,w,E,S,b,T,k,N,D,O,I=t[26]+"";return{c(){a=e("tr"),s=e("td"),v=n(I),p=o(),g=e("td"),w=e("div"),E=e("button"),S=n("View"),b=o(),T=e("button"),k=n("Delete"),N=o(),this.h()},l(t){a=l(t,"TR",{});var e=c(a);s=l(e,"TD",{class:!0});var n=c(s);v=r(n,I),n.forEach(i),p=h(e),g=l(e,"TD",{class:!0});var o=c(g);w=l(o,"DIV",{});var f=c(w);E=l(f,"BUTTON",{index:!0});var u=c(E);S=r(u,"View"),u.forEach(i),b=h(f),T=l(f,"BUTTON",{index:!0});var d=c(T);k=r(d,"Delete"),d.forEach(i),f.forEach(i),o.forEach(i),N=h(e),e.forEach(i),this.h()},h(){f(s,"class","w3-left-align"),f(E,"index",t[28]),f(T,"index",t[28]),f(g,"class","w3-right-align")},m(t,e){u(t,a,e),d(a,s),d(s,v),d(a,p),d(a,g),d(g,w),d(w,E),d(E,S),d(w,b),d(w,T),d(T,k),d(a,N),D||(O=[m(E,"click",st),m(T,"click",et)],D=!0)},p:y,d(t){t&&i(a),D=!1,x(O)}}}function tt(t){let a,s,o,h,v,p;return{c(){a=e("div"),s=e("div"),o=e("button"),h=n("Start Simulation"),this.h()},l(t){a=l(t,"DIV",{class:!0});var e=c(a);s=l(e,"DIV",{class:!0});var n=c(s);o=l(n,"BUTTON",{class:!0});var f=c(o);h=r(f,"Start Simulation"),f.forEach(i),n.forEach(i),e.forEach(i),this.h()},h(){f(o,"class","w3-col w3-input w3-border"),f(s,"class","w3-rest"),f(a,"class","w3-row w3-section")},m(e,n){u(e,a,n),d(a,s),d(s,o),d(o,h),v||(p=m(o,"click",t[10]),v=!0)},p:y,d(t){t&&i(a),v=!1,p()}}}function at(t){let a,s,m,v,g,b,D,x,y,V,$,B,R,j,U,F,_;s=new C({});let A="Communication"==t[1]&&W(t),L="Static"==t[1]&&Y(t),P="Driving Simulation"==t[1]&&tt(t);return{c(){a=o(),w(s.$$.fragment),m=o(),v=e("hr"),g=o(),b=e("div"),D=e("h1"),x=e("b"),y=n("Simulation"),V=o(),$=e("hr"),B=o(),A&&A.c(),R=o(),L&&L.c(),j=o(),P&&P.c(),U=o(),F=e("hr"),this.h()},l(t){I('[data-svelte="svelte-1smsifb"]',document.head).forEach(i),a=h(t),E(s.$$.fragment,t),m=h(t),v=l(t,"HR",{class:!0}),g=h(t),b=l(t,"DIV",{class:!0});var e=c(b);D=l(e,"H1",{class:!0,style:!0});var n=c(D);x=l(n,"B",{});var o=c(x);y=r(o,"Simulation"),o.forEach(i),n.forEach(i),e.forEach(i),V=h(t),$=l(t,"HR",{class:!0}),B=h(t),A&&A.l(t),R=h(t),L&&L.l(t),j=h(t),P&&P.l(t),U=h(t),F=l(t,"HR",{class:!0}),this.h()},h(){document.title="Simulation",f(v,"class","svelte-drd2kv"),f(D,"class","w3-text-yellow"),O(D,"text-shadow","1px 1px 0 #444"),f(b,"class","w3-panel w3-blue"),f($,"class","svelte-drd2kv"),f(F,"class","svelte-drd2kv")},m(t,e){u(t,a,e),S(s,t,e),u(t,m,e),u(t,v,e),u(t,g,e),u(t,b,e),d(b,D),d(D,x),d(x,y),u(t,V,e),u(t,$,e),u(t,B,e),A&&A.m(t,e),u(t,R,e),L&&L.m(t,e),u(t,j,e),P&&P.m(t,e),u(t,U,e),u(t,F,e),_=!0},p(t,a){"Communication"==t[1]?A?(A.p(t,a),2&a[0]&&p(A,1)):(A=W(t),A.c(),p(A,1),A.m(R.parentNode,R)):A&&(H(),T(A,1,1,(()=>{A=null})),N()),"Static"==t[1]?L?L.p(t,a):(L=Y(t),L.c(),L.m(j.parentNode,j)):L&&(L.d(1),L=null),"Driving Simulation"==t[1]?P?P.p(t,a):(P=tt(t),P.c(),P.m(U.parentNode,U)):P&&(P.d(1),P=null)},i(t){_||(p(s.$$.fragment,t),p(A),_=!0)},o(t){T(s.$$.fragment,t),T(A),_=!1},d(t){t&&i(a),k(s,t),t&&i(m),t&&i(v),t&&i(g),t&&i(b),t&&i(V),t&&i($),t&&i(B),A&&A.d(t),t&&i(R),L&&L.d(t),t&&i(j),P&&P.d(t),t&&i(U),t&&i(F)}}}function st(){}function et(){}function nt(){}function ot(){}function lt(t,a,s){let e=[],n={},o="";const l=A.subscribe((t=>{e=t})),c=L.subscribe((t=>{s(0,n=t)})),r=P.subscribe((t=>{s(1,o=t)}));let i=[];V((()=>{l(),c(),r();for(let t=0;t<i.length;t++)i[t].close()}));let h="Please create and select a scenario before starting the simulation.",f=!1,u=0,d=[],m={};function v(){for(const[t,a]of Object.entries(m))s(4,m[t]=[],m)}async function p(t){if(!f)return void F.danger("please create and activate a scenario first.");"start"==t&&v(),_("/simulation/comm","POST",{command:t,configs:n},(function(t){t.data&&(F.success("simulation started."),console.log("response of simulation",t.data))}))}function g(){for(var t=0;t<i.length;t++)ws=i[t],ws.close()}$((async()=>{let t="";for(let a=0;a<e.length;a++)e[a].activated&&(s(2,h=e[a].name),f=!0,t="/api/db1/scenario_configurations/ref-"+e[a]._id);!function(t,a){U(t,(function(t){let s=JSON.parse(t.response);s.data&&s.data.length>0&&(L.set(s.data[0]),a())}))}(t,(function(){if("Communication"==n.type){"configurations"in n&&s(3,u=n.configurations.length);for(var t=0;t<u;t++){s(4,m[t.toString()]=[],m);let a="ws://localhost:8000/simulation/comm/ws/"+t.toString(),e=new WebSocket(a);e.onopen=function(){window.console.log("Successfully connected to the echo websocket server...")},e.onmessage=function(t){let a=JSON.parse(t.data);console.log(a,"printing JSON now");let e=a.client_index,n=JSON.parse(a.data);"status"in n?d[e]=n.status:s(4,m[e]=[...m[e],n],m)},i.push(e)}}"Static"==n.type&&console.log("hello static sample"),"Communication"==n.type&&console.log("hello driving scenario")}))}));return[n,o,h,u,m,[],v,p,g,function(){_("/simulation/static","POST",{configs:n},(function(t){t.data&&(F.success("simulation started."),console.log("response of simulation",t.data))}))},function(){_("/simulation/static","POST",{configs:n},(function(t){t.data&&(F.success("simulation started."),console.log("response of simulation",t.data))}))},()=>p("start"),()=>p("stop"),()=>g(),function(a,e){t.$$.not_equal(m[e.toString()],a)&&(m[e.toString()]=a,s(4,m))}]}export default class extends t{constructor(t){super(),a(this,t,lt,at,s,{},[-1,-1])}}
