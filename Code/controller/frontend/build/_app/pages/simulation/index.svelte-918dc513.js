import{S as t,i as s,s as a,e,t as n,k as o,c,a as l,g as i,d as r,n as u,b as f,f as d,F as h,G as m,h as p,v as g,l as v,j as w,m as S,o as b,a6 as E,r as k,w as N,u as $,M as O,Q as T,N as D,H as y,L as x,R as I,z as H,B as V,a4 as j,a5 as B}from"../../chunks/vendor-c052606d.js";import{T as R}from"../../chunks/index-e04611e2.js";import{T as C,x as U,n as _,a as F}from"../../chunks/requests-531e903b.js";import{s as J,a as L,b as P}from"../../chunks/store-ce76cd4a.js";/* empty css                                                       */function W(t,s,a){const e=t.slice();return e[30]=s[a],e[31]=s,e[32]=a,e}function q(t){let s,a,v,w,S,b,E,N,O,D,y,x,I,H,j,B,R,C,U,_,F,J,L,P,W,q,z,G,M,Q,K,X,Y,Z,tt,st,at="configurations"in t[0]&&A(t);return{c(){s=e("h4"),a=n("Scenario: "),v=n(t[2]),w=n(" Number of Containers: "),S=n(t[3]),b=n("."),E=o(),N=e("div"),O=e("div"),D=e("button"),y=n("Start Simulation"),x=o(),I=e("div"),H=e("button"),j=n("Stop Simulation"),B=o(),R=e("div"),C=e("button"),U=n("Reset WS Connection"),_=o(),F=e("hr"),J=o(),L=e("section"),P=e("h3"),W=n("Application Logs"),q=o(),z=e("button"),G=n("Clear Logs"),M=o(),at&&at.c(),Q=o(),K=e("br"),X=o(),Y=e("hr"),this.h()},l(e){s=c(e,"H4",{});var n=l(s);a=i(n,"Scenario: "),v=i(n,t[2]),w=i(n," Number of Containers: "),S=i(n,t[3]),b=i(n,"."),n.forEach(r),E=u(e),N=c(e,"DIV",{class:!0});var o=l(N);O=c(o,"DIV",{class:!0});var f=l(O);D=c(f,"BUTTON",{class:!0});var d=l(D);y=i(d,"Start Simulation"),d.forEach(r),f.forEach(r),x=u(o),I=c(o,"DIV",{class:!0});var h=l(I);H=c(h,"BUTTON",{class:!0});var m=l(H);j=i(m,"Stop Simulation"),m.forEach(r),h.forEach(r),B=u(o),R=c(o,"DIV",{class:!0});var p=l(R);C=c(p,"BUTTON",{class:!0});var g=l(C);U=i(g,"Reset WS Connection"),g.forEach(r),p.forEach(r),o.forEach(r),_=u(e),F=c(e,"HR",{class:!0}),J=u(e),L=c(e,"SECTION",{class:!0});var k=l(L);P=c(k,"H3",{});var $=l(P);W=i($,"Application Logs"),$.forEach(r),k.forEach(r),q=u(e),z=c(e,"BUTTON",{class:!0});var T=l(z);G=i(T,"Clear Logs"),T.forEach(r),M=u(e),at&&at.l(e),Q=u(e),K=c(e,"BR",{}),X=u(e),Y=c(e,"HR",{class:!0}),this.h()},h(){f(D,"class","w3-col w3-input w3-border"),f(O,"class","w3-third"),f(H,"class","w3-col w3-input w3-border"),f(I,"class","w3-third"),f(C,"class","w3-col w3-input w3-border"),f(R,"class","w3-third"),f(N,"class","w3-row w3-section"),f(F,"class","svelte-drd2kv"),f(L,"class","page-headline"),f(z,"class","w3-col w3-input w3-border w3-button"),f(Y,"class","svelte-drd2kv")},m(e,n){d(e,s,n),h(s,a),h(s,v),h(s,w),h(s,S),h(s,b),d(e,E,n),d(e,N,n),h(N,O),h(O,D),h(D,y),h(N,x),h(N,I),h(I,H),h(H,j),h(N,B),h(N,R),h(R,C),h(C,U),d(e,_,n),d(e,F,n),d(e,J,n),d(e,L,n),h(L,P),h(P,W),d(e,q,n),d(e,z,n),h(z,G),d(e,M,n),at&&at.m(e,n),d(e,Q,n),d(e,K,n),d(e,X,n),d(e,Y,n),Z=!0,tt||(st=[m(D,"click",t[13]),m(H,"click",t[14]),m(C,"click",t[15]),m(z,"click",t[6])],tt=!0)},p(t,s){(!Z||4&s[0])&&p(v,t[2]),(!Z||8&s[0])&&p(S,t[3]),"configurations"in t[0]?at?(at.p(t,s),1&s[0]&&g(at,1)):(at=A(t),at.c(),g(at,1),at.m(Q.parentNode,Q)):at&&(V(),k(at,1,1,(()=>{at=null})),$())},i(t){Z||(g(at),Z=!0)},o(t){k(at),Z=!1},d(t){t&&r(s),t&&r(E),t&&r(N),t&&r(_),t&&r(F),t&&r(J),t&&r(L),t&&r(q),t&&r(z),t&&r(M),at&&at.d(t),t&&r(Q),t&&r(K),t&&r(X),t&&r(Y),tt=!1,T(st)}}}function A(t){let s,a,e=t[0].configurations.length>0&&z(t);return{c(){e&&e.c(),s=v()},l(t){e&&e.l(t),s=v()},m(t,n){e&&e.m(t,n),d(t,s,n),a=!0},p(t,a){t[0].configurations.length>0?e?(e.p(t,a),1&a[0]&&g(e,1)):(e=z(t),e.c(),g(e,1),e.m(s.parentNode,s)):e&&(V(),k(e,1,1,(()=>{e=null})),$())},i(t){a||(g(e),a=!0)},o(t){k(e),a=!1},d(t){e&&e.d(t),t&&r(s)}}}function z(t){let s,a,e=t[0].configurations,n=[];for(let c=0;c<e.length;c+=1)n[c]=K(W(t,e,c));const o=t=>k(n[t],1,1,(()=>{n[t]=null}));return{c(){for(let t=0;t<n.length;t+=1)n[t].c();s=v()},l(t){for(let s=0;s<n.length;s+=1)n[s].l(t);s=v()},m(t,e){for(let s=0;s<n.length;s+=1)n[s].m(t,e);d(t,s,e),a=!0},p(t,a){if(17&a[0]){let c;for(e=t[0].configurations,c=0;c<e.length;c+=1){const o=W(t,e,c);n[c]?(n[c].p(o,a),g(n[c],1)):(n[c]=K(o),n[c].c(),g(n[c],1),n[c].m(s.parentNode,s))}for(V(),c=e.length;c<n.length;c+=1)o(c);$()}},i(t){if(!a){for(let t=0;t<e.length;t+=1)g(n[t]);a=!0}},o(t){n=n.filter(Boolean);for(let s=0;s<n.length;s+=1)k(n[s]);a=!1},d(t){O(n,t),t&&r(s)}}}function G(t){let s,a,e=t[32].toString()in t[4],n=e&&M(t);return{c(){n&&n.c(),s=v()},l(t){n&&n.l(t),s=v()},m(t,e){n&&n.m(t,e),d(t,s,e),a=!0},p(t,a){16&a[0]&&(e=t[32].toString()in t[4]),e?n?(n.p(t,a),16&a[0]&&g(n,1)):(n=M(t),n.c(),g(n,1),n.m(s.parentNode,s)):n&&(V(),k(n,1,1,(()=>{n=null})),$())},i(t){a||(g(n),a=!0)},o(t){k(n),a=!1},d(t){n&&n.d(t),t&&r(s)}}}function M(t){let s,a,e=t[4][t[32].toString()].length>0,n=e&&Q(t);return{c(){n&&n.c(),s=v()},l(t){n&&n.l(t),s=v()},m(t,e){n&&n.m(t,e),d(t,s,e),a=!0},p(t,a){16&a[0]&&(e=t[4][t[32].toString()].length>0),e?n?(n.p(t,a),16&a[0]&&g(n,1)):(n=Q(t),n.c(),g(n,1),n.m(s.parentNode,s)):n&&(V(),k(n,1,1,(()=>{n=null})),$())},i(t){a||(g(n),a=!0)},o(t){k(n),a=!1},d(t){n&&n.d(t),t&&r(s)}}}function Q(t){let s,a,f,m,v,$,O=t[30].container_info.name+"";function T(s){t[16](s,t[32])}let D={title:t[30].container_info.name,headers:Object.keys(t[4][t[32].toString()][0])};return void 0!==t[4][t[32].toString()]&&(D.data=t[4][t[32].toString()]),m=new R({props:D}),j.push((()=>B(m,"data",T))),{c(){s=e("h5"),a=n(O),f=o(),w(m.$$.fragment)},l(t){s=c(t,"H5",{});var e=l(s);a=i(e,O),e.forEach(r),f=u(t),S(m.$$.fragment,t)},m(t,e){d(t,s,e),h(s,a),d(t,f,e),b(m,t,e),$=!0},p(s,e){t=s,(!$||1&e[0])&&O!==(O=t[30].container_info.name+"")&&p(a,O);const n={};1&e[0]&&(n.title=t[30].container_info.name),16&e[0]&&(n.headers=Object.keys(t[4][t[32].toString()][0])),!v&&16&e[0]&&(v=!0,n.data=t[4][t[32].toString()],E((()=>v=!1))),m.$set(n)},i(t){$||(g(m.$$.fragment,t),$=!0)},o(t){k(m.$$.fragment,t),$=!1},d(t){t&&r(s),t&&r(f),N(m,t)}}}function K(t){let s,a,e=Object.keys(t[4]).length>0,n=e&&G(t);return{c(){n&&n.c(),s=v()},l(t){n&&n.l(t),s=v()},m(t,e){n&&n.m(t,e),d(t,s,e),a=!0},p(t,a){16&a[0]&&(e=Object.keys(t[4]).length>0),e?n?(n.p(t,a),16&a[0]&&g(n,1)):(n=G(t),n.c(),g(n,1),n.m(s.parentNode,s)):n&&(V(),k(n,1,1,(()=>{n=null})),$())},i(t){a||(g(n),a=!0)},o(t){k(n),a=!1},d(t){n&&n.d(t),t&&r(s)}}}function X(t){let s,a,p,v,w,S,b,E,N,O,y,x,I,H,j,B,R,C,U,_,F,J,L,P,W,q,A,z,G,M,Q,K=t[5].length>0&&Y(t);return{c(){s=e("div"),a=e("div"),p=e("button"),v=n("Start Simulation"),w=o(),S=e("hr"),b=o(),E=e("div"),N=e("h1"),O=e("b"),y=n("Edit Files"),x=o(),K&&K.c(),I=o(),H=e("hr"),j=o(),B=e("div"),R=e("div"),C=e("input"),U=o(),_=e("div"),F=e("button"),J=n("Delete Files"),L=o(),P=e("div"),W=e("button"),q=n("Export Files"),A=o(),z=e("hr"),this.h()},l(t){s=c(t,"DIV",{class:!0});var e=l(s);a=c(e,"DIV",{class:!0});var n=l(a);p=c(n,"BUTTON",{class:!0});var o=l(p);v=i(o,"Start Simulation"),o.forEach(r),n.forEach(r),e.forEach(r),w=u(t),S=c(t,"HR",{class:!0}),b=u(t),E=c(t,"DIV",{class:!0});var f=l(E);N=c(f,"H1",{class:!0,style:!0});var d=l(N);O=c(d,"B",{});var h=l(O);y=i(h,"Edit Files"),h.forEach(r),d.forEach(r),f.forEach(r),x=u(t),K&&K.l(t),I=u(t),H=c(t,"HR",{class:!0}),j=u(t),B=c(t,"DIV",{class:!0});var m=l(B);R=c(m,"DIV",{class:!0});var g=l(R);C=c(g,"INPUT",{id:!0,class:!0,name:!0,type:!0,placeholder:!0}),g.forEach(r),U=u(m),_=c(m,"DIV",{class:!0});var k=l(_);F=c(k,"BUTTON",{class:!0});var $=l(F);J=i($,"Delete Files"),$.forEach(r),k.forEach(r),L=u(m),P=c(m,"DIV",{class:!0});var T=l(P);W=c(T,"BUTTON",{class:!0});var D=l(W);q=i(D,"Export Files"),D.forEach(r),T.forEach(r),m.forEach(r),A=u(t),z=c(t,"HR",{class:!0}),this.h()},h(){f(p,"class","w3-col w3-input w3-border"),f(a,"class","w3-rest"),f(s,"class","w3-row w3-section"),f(S,"class","svelte-drd2kv"),f(N,"class","w3-text-yellow"),D(N,"text-shadow","1px 1px 0 #444"),f(E,"class","w3-panel w3-blue"),f(H,"class","svelte-drd2kv"),f(C,"id","filename"),f(C,"class","w3-input w3-border"),f(C,"name","filename"),f(C,"type","text"),f(C,"placeholder","Filename"),f(R,"class","w3-rest"),f(F,"class","w3-col w3-input w3-border"),f(_,"class","w3-half"),f(W,"class","w3-col w3-input w3-border"),f(P,"class","w3-half"),f(B,"class","w3-row w3-section"),f(z,"class","svelte-drd2kv")},m(e,n){d(e,s,n),h(s,a),h(a,p),h(p,v),d(e,w,n),d(e,S,n),d(e,b,n),d(e,E,n),h(E,N),h(N,O),h(O,y),d(e,x,n),K&&K.m(e,n),d(e,I,n),d(e,H,n),d(e,j,n),d(e,B,n),h(B,R),h(R,C),h(B,U),h(B,_),h(_,F),h(F,J),h(B,L),h(B,P),h(P,W),h(W,q),d(e,A,n),d(e,z,n),G=!0,M||(Q=[m(p,"click",t[9]),m(F,"click",t[11]),m(W,"click",t[12])],M=!0)},p(t,s){t[5].length>0?K?(K.p(t,s),32&s[0]&&g(K,1)):(K=Y(t),K.c(),g(K,1),K.m(I.parentNode,I)):K&&(V(),k(K,1,1,(()=>{K=null})),$())},i(t){G||(g(K),G=!0)},o(t){k(K),G=!1},d(t){t&&r(s),t&&r(w),t&&r(S),t&&r(b),t&&r(E),t&&r(x),K&&K.d(t),t&&r(I),t&&r(H),t&&r(j),t&&r(B),t&&r(A),t&&r(z),M=!1,T(Q)}}}function Y(t){let s,a,e;function n(s){t[17](s)}let o={title:"static simulation data",headers:Object.keys(t[5][0])};return void 0!==t[5]&&(o.data=t[5]),s=new R({props:o}),j.push((()=>B(s,"data",n))),{c(){w(s.$$.fragment)},l(t){S(s.$$.fragment,t)},m(t,a){b(s,t,a),e=!0},p(t,e){const n={};32&e[0]&&(n.headers=Object.keys(t[5][0])),!a&&32&e[0]&&(a=!0,n.data=t[5],E((()=>a=!1))),s.$set(n)},i(t){e||(g(s.$$.fragment,t),e=!0)},o(t){k(s.$$.fragment,t),e=!1},d(t){N(s,t)}}}function Z(t){let s,a,o,u,p,g;return{c(){s=e("div"),a=e("div"),o=e("button"),u=n("Start Simulation"),this.h()},l(t){s=c(t,"DIV",{class:!0});var e=l(s);a=c(e,"DIV",{class:!0});var n=l(a);o=c(n,"BUTTON",{class:!0});var f=l(o);u=i(f,"Start Simulation"),f.forEach(r),n.forEach(r),e.forEach(r),this.h()},h(){f(o,"class","w3-col w3-input w3-border"),f(a,"class","w3-rest"),f(s,"class","w3-row w3-section")},m(e,n){d(e,s,n),h(s,a),h(a,o),h(o,u),p||(g=m(o,"click",t[10]),p=!0)},p:y,d(t){t&&r(s),p=!1,g()}}}function tt(t){let s,a,m,p,v,E,O,T,y,I,H,j,B,R,U,_,F;a=new C({});let J="Communication"==t[1]&&q(t),L="Static"==t[1]&&X(t),P="Driving Simulation"==t[1]&&Z(t);return{c(){s=o(),w(a.$$.fragment),m=o(),p=e("hr"),v=o(),E=e("div"),O=e("h1"),T=e("b"),y=n("Simulation"),I=o(),H=e("hr"),j=o(),J&&J.c(),B=o(),L&&L.c(),R=o(),P&&P.c(),U=o(),_=e("hr"),this.h()},l(t){x('[data-svelte="svelte-1smsifb"]',document.head).forEach(r),s=u(t),S(a.$$.fragment,t),m=u(t),p=c(t,"HR",{class:!0}),v=u(t),E=c(t,"DIV",{class:!0});var e=l(E);O=c(e,"H1",{class:!0,style:!0});var n=l(O);T=c(n,"B",{});var o=l(T);y=i(o,"Simulation"),o.forEach(r),n.forEach(r),e.forEach(r),I=u(t),H=c(t,"HR",{class:!0}),j=u(t),J&&J.l(t),B=u(t),L&&L.l(t),R=u(t),P&&P.l(t),U=u(t),_=c(t,"HR",{class:!0}),this.h()},h(){document.title="Simulation",f(p,"class","svelte-drd2kv"),f(O,"class","w3-text-yellow"),D(O,"text-shadow","1px 1px 0 #444"),f(E,"class","w3-panel w3-blue"),f(H,"class","svelte-drd2kv"),f(_,"class","svelte-drd2kv")},m(t,e){d(t,s,e),b(a,t,e),d(t,m,e),d(t,p,e),d(t,v,e),d(t,E,e),h(E,O),h(O,T),h(T,y),d(t,I,e),d(t,H,e),d(t,j,e),J&&J.m(t,e),d(t,B,e),L&&L.m(t,e),d(t,R,e),P&&P.m(t,e),d(t,U,e),d(t,_,e),F=!0},p(t,s){"Communication"==t[1]?J?(J.p(t,s),2&s[0]&&g(J,1)):(J=q(t),J.c(),g(J,1),J.m(B.parentNode,B)):J&&(V(),k(J,1,1,(()=>{J=null})),$()),"Static"==t[1]?L?(L.p(t,s),2&s[0]&&g(L,1)):(L=X(t),L.c(),g(L,1),L.m(R.parentNode,R)):L&&(V(),k(L,1,1,(()=>{L=null})),$()),"Driving Simulation"==t[1]?P?P.p(t,s):(P=Z(t),P.c(),P.m(U.parentNode,U)):P&&(P.d(1),P=null)},i(t){F||(g(a.$$.fragment,t),g(J),g(L),F=!0)},o(t){k(a.$$.fragment,t),k(J),k(L),F=!1},d(t){t&&r(s),N(a,t),t&&r(m),t&&r(p),t&&r(v),t&&r(E),t&&r(I),t&&r(H),t&&r(j),J&&J.d(t),t&&r(B),L&&L.d(t),t&&r(R),P&&P.d(t),t&&r(U),t&&r(_)}}}function st(t,s,a){let e=[],n={},o="";const c=J.subscribe((t=>{e=t})),l=L.subscribe((t=>{a(0,n=t)})),i=P.subscribe((t=>{a(1,o=t)}));let r=[],u=[];I((()=>{c(),l(),i();for(let t=0;t<r.length;t++)r[t].close();for(let t=0;t<u.length;t++)u[t].close()}));let f="Please create and select a scenario before starting the simulation.",d=!1,h=0,m=[],p={},g=[];function v(){for(const[t,s]of Object.entries(p))a(4,p[t]=[],p)}async function w(t){if(!d)return void _.danger("please create and activate a scenario first.");"start"==t&&v(),F("/simulation/comm","POST",{command:t,configs:n},(function(t){t.data&&(_.success("simulation started."),console.log("response of simulation",t.data))}))}function S(){for(var t=0;t<r.length;t++)ws=r[t],ws.close()}H((async()=>{let t="";for(let s=0;s<e.length;s++)e[s].activated&&(a(2,f=e[s].name),d=!0,t="/api/db1/scenario_configurations/ref-"+e[s]._id);!function(t,s){U(t,(function(t){let a=JSON.parse(t.response);a.data&&a.data.length>0&&(L.set(a.data[0]),s())}))}(t,(function(){if("Communication"==n.type){"configurations"in n&&a(3,h=n.configurations.length);for(var t=0;t<h;t++){a(4,p[t.toString()]=[],p);let s="ws://localhost:8000/simulation/comm/ws/"+t.toString(),e=new WebSocket(s);e.onopen=function(){window.console.log("Successfully connected to the echo websocket server...")},e.onmessage=function(t){let s=JSON.parse(t.data);console.log(s,"printing JSON now");let e=s.client_index,n=JSON.parse(s.data);"status"in n?m[e]=n.status:a(4,p[e]=[...p[e],n],p)},r.push(e)}}if("Static"==n.type){console.log("hello static sample");let t=new WebSocket("ws://localhost:8000/simulation/static/ws");t.onopen=function(){window.console.log("static simulation websocket")},t.onmessage=function(t){let s=JSON.parse(t.data);a(5,g=[...g,s])},u.push(t)}"Communication"==n.type&&console.log("hello driving scenario")}))}));return[n,o,f,h,p,g,v,w,S,function(){F("/simulation/static","POST",{configs:n},(function(t){t.data&&(_.success("simulation started."),console.log("response of simulation",t.data))}))},function(){F("/simulation/static","POST",{configs:n},(function(t){t.data&&(_.success("simulation started."),console.log("response of simulation",t.data))}))},function(){F("/simulation/static","DELETE",{configs:n},(function(t){t.data&&(_.success("Delete successful."),console.log("response of simulation",t.data))}))},function(){U("/simulation/static",(function(t){let s=JSON.parse(t.response);s.data&&(_.success("Download successful."),console.log("response of export files ...",s.data))}))},()=>w("start"),()=>w("stop"),()=>S(),function(s,e){t.$$.not_equal(p[e.toString()],s)&&(p[e.toString()]=s,a(4,p))},function(t){g=t,a(5,g)}]}export default class extends t{constructor(t){super(),s(this,t,st,tt,a,{},[-1,-1])}}
