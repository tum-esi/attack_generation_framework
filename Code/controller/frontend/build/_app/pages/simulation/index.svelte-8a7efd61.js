import{S as s,i as a,s as o,e as t,t as e,k as n,c as l,a as c,g as r,n as i,d as u,f,F as h,h as d,L as g,b as v,N as m,G as w,H as p,M as b,Q as S,R as E,z as k,a3 as N}from"../../chunks/vendor-5cf7a4b5.js";import{a as x}from"../../chunks/requests-a0662dff.js";import{s as H,a as T}from"../../chunks/store-f8ef346b.js";function L(s,a,o){const t=s.slice();return t[17]=a[o],t[18]=a,t[19]=o,t}function O(s){let a,o,g,v=s[17]+"",m=s[19];const w=()=>s[8](a,m),p=()=>s[8](null,m);return{c(){a=t("li"),o=e(v),g=n()},l(s){a=l(s,"LI",{});var t=c(a);o=r(t,v),g=i(t),t.forEach(u)},m(s,t){f(s,a,t),h(a,o),h(a,g),w()},p(a,t){s=a,4&t&&v!==(v=s[17]+"")&&d(o,v),m!==s[19]&&(p(),m=s[19],w())},d(s){s&&u(a),p()}}}function I(s){let a,o,E,k,N,x,H,T,I,R,y,B,C,D,U,V,_,j,A,J,P,q,z,F,G,M,Q,W,K,X,Y,Z,$,ss,as,os,ts,es,ns,ls,cs,rs,is=s[2],us=[];for(let t=0;t<is.length;t+=1)us[t]=O(L(s,is,t));return{c(){a=n(),o=t("hr"),E=n(),k=t("div"),N=t("h1"),x=t("b"),H=e("Simulation"),T=n(),I=t("hr"),R=n(),y=t("h4"),B=e("Scenario: "),C=e(s[0]),D=e(" Number of Containers: "),U=e(s[1]),V=e("."),_=n(),j=t("div"),A=t("div"),J=t("button"),P=e("Start Simulation"),q=n(),z=t("div"),F=t("button"),G=e("Stop Simulation"),M=n(),Q=t("hr"),W=n(),K=t("section"),X=t("h3"),Y=e("Application Logs"),Z=n(),$=t("button"),ss=e("Clear Logs"),as=n(),os=t("ul");for(let s=0;s<us.length;s+=1)us[s].c();ts=n(),es=t("br"),ns=n(),ls=t("hr"),this.h()},l(t){g('[data-svelte="svelte-1smsifb"]',document.head).forEach(u),a=i(t),o=l(t,"HR",{class:!0}),E=i(t),k=l(t,"DIV",{class:!0});var e=c(k);N=l(e,"H1",{class:!0,style:!0});var n=c(N);x=l(n,"B",{});var f=c(x);H=r(f,"Simulation"),f.forEach(u),n.forEach(u),e.forEach(u),T=i(t),I=l(t,"HR",{class:!0}),R=i(t),y=l(t,"H4",{});var h=c(y);B=r(h,"Scenario: "),C=r(h,s[0]),D=r(h," Number of Containers: "),U=r(h,s[1]),V=r(h,"."),h.forEach(u),_=i(t),j=l(t,"DIV",{class:!0});var d=c(j);A=l(d,"DIV",{class:!0});var v=c(A);J=l(v,"BUTTON",{class:!0});var m=c(J);P=r(m,"Start Simulation"),m.forEach(u),v.forEach(u),q=i(d),z=l(d,"DIV",{class:!0});var w=c(z);F=l(w,"BUTTON",{class:!0});var p=c(F);G=r(p,"Stop Simulation"),p.forEach(u),w.forEach(u),d.forEach(u),M=i(t),Q=l(t,"HR",{class:!0}),W=i(t),K=l(t,"SECTION",{class:!0});var b=c(K);X=l(b,"H3",{});var S=c(X);Y=r(S,"Application Logs"),S.forEach(u),b.forEach(u),Z=i(t),$=l(t,"BUTTON",{class:!0});var L=c($);ss=r(L,"Clear Logs"),L.forEach(u),as=i(t),os=l(t,"UL",{});var O=c(os);for(let s=0;s<us.length;s+=1)us[s].l(O);O.forEach(u),ts=i(t),es=l(t,"BR",{}),ns=i(t),ls=l(t,"HR",{class:!0}),this.h()},h(){document.title="Simulation",v(o,"class","svelte-drd2kv"),v(N,"class","w3-text-yellow"),m(N,"text-shadow","1px 1px 0 #444"),v(k,"class","w3-panel w3-blue"),v(I,"class","svelte-drd2kv"),v(J,"class","w3-col w3-input w3-border w3-margin"),v(A,"class","w3-half"),v(F,"class","w3-col w3-input w3-border w3-margin"),v(z,"class","w3-half"),v(j,"class","w3-row w3-section"),v(Q,"class","svelte-drd2kv"),v(K,"class","page-headline"),v($,"class","w3-col w3-input w3-border w3-button"),v(ls,"class","svelte-drd2kv")},m(t,e){f(t,a,e),f(t,o,e),f(t,E,e),f(t,k,e),h(k,N),h(N,x),h(x,H),f(t,T,e),f(t,I,e),f(t,R,e),f(t,y,e),h(y,B),h(y,C),h(y,D),h(y,U),h(y,V),f(t,_,e),f(t,j,e),h(j,A),h(A,J),h(J,P),h(j,q),h(j,z),h(z,F),h(F,G),f(t,M,e),f(t,Q,e),f(t,W,e),f(t,K,e),h(K,X),h(X,Y),f(t,Z,e),f(t,$,e),h($,ss),f(t,as,e),f(t,os,e);for(let s=0;s<us.length;s+=1)us[s].m(os,null);f(t,ts,e),f(t,es,e),f(t,ns,e),f(t,ls,e),cs||(rs=[w(J,"click",s[6]),w(F,"click",s[7]),w($,"click",s[4])],cs=!0)},p(s,[a]){if(1&a&&d(C,s[0]),2&a&&d(U,s[1]),12&a){let o;for(is=s[2],o=0;o<is.length;o+=1){const t=L(s,is,o);us[o]?us[o].p(t,a):(us[o]=O(t),us[o].c(),us[o].m(os,null))}for(;o<us.length;o+=1)us[o].d(1);us.length=is.length}},i:p,o:p,d(s){s&&u(a),s&&u(o),s&&u(E),s&&u(k),s&&u(T),s&&u(I),s&&u(R),s&&u(y),s&&u(_),s&&u(j),s&&u(M),s&&u(Q),s&&u(W),s&&u(K),s&&u(Z),s&&u($),s&&u(as),s&&u(os),b(us,s),s&&u(ts),s&&u(es),s&&u(ns),s&&u(ls),cs=!1,S(rs)}}}function R(s,a,o){let t=[],e={};const n=H.subscribe((s=>{t=s})),l=T.subscribe((s=>{e=s}));E((()=>{n(),l()}));let c="Please create and select a scenario before starting the simulation.",r=0,i=[],u=[],f=[],h=["event1","event2","event3"],d=[];async function g(s){console.log("start or stop simulation"),x("/simulation","POST",{command:s,configs:e},(function(s){s.data&&console.log("response of start simulation",s.data)}))}k((async()=>{for(let a=0;a<t.length;a++)t[a].activated&&o(0,c=t[a].name);"configurations"in e&&o(1,r=e.configurations.length),console.log("scenarios",t),console.log("scenario_configurations",e),i=[];for(var s=0;s<r;s++){let a=e.configurations[s].container_info.name,o=e.configurations[s].container_info.ports.split(",")[0].split("/")[0];console.log("sending to controller websocket: index",s,"name",a,"port",o);let t="ws://localhost:8000/simulation/ws/"+a+"/"+o+"/"+s.toString();console.log("ws url:",t);let n=new WebSocket(t);n.onopen=function(){window.console.log("Successfully connected to the echo websocket server...")},n.onmessage=function(s){window.console.log(s,"received ws message");let a=JSON.parse(s.data);console.log(a,"printing JSON now");let o=a.client_index,t=a.data;"status"in t&&(u[o]=t.status),"data"in t&&(f[o]=t.data),console.log(f)},i.push(n)}}));return[c,r,h,d,function(){o(2,h=["event1","event2","event3"])},g,()=>g("start"),()=>g("stop"),function(s,a){N[s?"unshift":"push"]((()=>{d[a]=s,o(3,d)}))}]}export default class extends s{constructor(s){super(),a(this,s,R,I,o,{})}}
