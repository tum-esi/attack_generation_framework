import{S as t,i as s,s as a,e,t as n,k as o,c,a as l,g as i,d as r,n as u,b as f,f as d,F as h,G as m,h as p,v as g,l as v,j as w,m as S,o as b,a6 as E,r as k,w as $,u as N,M as O,Q as T,N as y,H as D,L as x,R as H,z as j,B as I,a4 as B,a5 as R}from"../../chunks/vendor-c052606d.js";import{T as V}from"../../chunks/index-e04611e2.js";import{T as C,x as _,n as U,a as L}from"../../chunks/requests-531e903b.js";import{s as F,a as J,b as P}from"../../chunks/store-ce76cd4a.js";/* empty css                                                       */function W(t,s,a){const e=t.slice();return e[30]=s[a],e[31]=s,e[32]=a,e}function q(t){let s,a,v,w,S,b,E,$,O,y,D,x,H,j,B,R,V,C,_,U,L,F,J,P,W,q,z,G,M,Q,K,X,Y,Z,tt,st,at="configurations"in t[0]&&A(t);return{c(){s=e("h4"),a=n("Scenario: "),v=n(t[2]),w=n(" Number of Containers: "),S=n(t[3]),b=n("."),E=o(),$=e("div"),O=e("div"),y=e("button"),D=n("Start Simulation"),x=o(),H=e("div"),j=e("button"),B=n("Stop Simulation"),R=o(),V=e("div"),C=e("button"),_=n("Reset WS Connection"),U=o(),L=e("hr"),F=o(),J=e("section"),P=e("h3"),W=n("Application Logs"),q=o(),z=e("button"),G=n("Clear Logs"),M=o(),at&&at.c(),Q=o(),K=e("br"),X=o(),Y=e("hr"),this.h()},l(e){s=c(e,"H4",{});var n=l(s);a=i(n,"Scenario: "),v=i(n,t[2]),w=i(n," Number of Containers: "),S=i(n,t[3]),b=i(n,"."),n.forEach(r),E=u(e),$=c(e,"DIV",{class:!0});var o=l($);O=c(o,"DIV",{class:!0});var f=l(O);y=c(f,"BUTTON",{class:!0});var d=l(y);D=i(d,"Start Simulation"),d.forEach(r),f.forEach(r),x=u(o),H=c(o,"DIV",{class:!0});var h=l(H);j=c(h,"BUTTON",{class:!0});var m=l(j);B=i(m,"Stop Simulation"),m.forEach(r),h.forEach(r),R=u(o),V=c(o,"DIV",{class:!0});var p=l(V);C=c(p,"BUTTON",{class:!0});var g=l(C);_=i(g,"Reset WS Connection"),g.forEach(r),p.forEach(r),o.forEach(r),U=u(e),L=c(e,"HR",{class:!0}),F=u(e),J=c(e,"SECTION",{class:!0});var k=l(J);P=c(k,"H3",{});var N=l(P);W=i(N,"Application Logs"),N.forEach(r),k.forEach(r),q=u(e),z=c(e,"BUTTON",{class:!0});var T=l(z);G=i(T,"Clear Logs"),T.forEach(r),M=u(e),at&&at.l(e),Q=u(e),K=c(e,"BR",{}),X=u(e),Y=c(e,"HR",{class:!0}),this.h()},h(){f(y,"class","w3-col w3-input w3-border"),f(O,"class","w3-third"),f(j,"class","w3-col w3-input w3-border"),f(H,"class","w3-third"),f(C,"class","w3-col w3-input w3-border"),f(V,"class","w3-third"),f($,"class","w3-row w3-section"),f(L,"class","svelte-drd2kv"),f(J,"class","page-headline"),f(z,"class","w3-col w3-input w3-border w3-button"),f(Y,"class","svelte-drd2kv")},m(e,n){d(e,s,n),h(s,a),h(s,v),h(s,w),h(s,S),h(s,b),d(e,E,n),d(e,$,n),h($,O),h(O,y),h(y,D),h($,x),h($,H),h(H,j),h(j,B),h($,R),h($,V),h(V,C),h(C,_),d(e,U,n),d(e,L,n),d(e,F,n),d(e,J,n),h(J,P),h(P,W),d(e,q,n),d(e,z,n),h(z,G),d(e,M,n),at&&at.m(e,n),d(e,Q,n),d(e,K,n),d(e,X,n),d(e,Y,n),Z=!0,tt||(st=[m(y,"click",t[12]),m(j,"click",t[13]),m(C,"click",t[14]),m(z,"click",t[6])],tt=!0)},p(t,s){(!Z||4&s[0])&&p(v,t[2]),(!Z||8&s[0])&&p(S,t[3]),"configurations"in t[0]?at?(at.p(t,s),1&s[0]&&g(at,1)):(at=A(t),at.c(),g(at,1),at.m(Q.parentNode,Q)):at&&(I(),k(at,1,1,(()=>{at=null})),N())},i(t){Z||(g(at),Z=!0)},o(t){k(at),Z=!1},d(t){t&&r(s),t&&r(E),t&&r($),t&&r(U),t&&r(L),t&&r(F),t&&r(J),t&&r(q),t&&r(z),t&&r(M),at&&at.d(t),t&&r(Q),t&&r(K),t&&r(X),t&&r(Y),tt=!1,T(st)}}}function A(t){let s,a,e=t[0].configurations.length>0&&z(t);return{c(){e&&e.c(),s=v()},l(t){e&&e.l(t),s=v()},m(t,n){e&&e.m(t,n),d(t,s,n),a=!0},p(t,a){t[0].configurations.length>0?e?(e.p(t,a),1&a[0]&&g(e,1)):(e=z(t),e.c(),g(e,1),e.m(s.parentNode,s)):e&&(I(),k(e,1,1,(()=>{e=null})),N())},i(t){a||(g(e),a=!0)},o(t){k(e),a=!1},d(t){e&&e.d(t),t&&r(s)}}}function z(t){let s,a,e=t[0].configurations,n=[];for(let c=0;c<e.length;c+=1)n[c]=K(W(t,e,c));const o=t=>k(n[t],1,1,(()=>{n[t]=null}));return{c(){for(let t=0;t<n.length;t+=1)n[t].c();s=v()},l(t){for(let s=0;s<n.length;s+=1)n[s].l(t);s=v()},m(t,e){for(let s=0;s<n.length;s+=1)n[s].m(t,e);d(t,s,e),a=!0},p(t,a){if(17&a[0]){let c;for(e=t[0].configurations,c=0;c<e.length;c+=1){const o=W(t,e,c);n[c]?(n[c].p(o,a),g(n[c],1)):(n[c]=K(o),n[c].c(),g(n[c],1),n[c].m(s.parentNode,s))}for(I(),c=e.length;c<n.length;c+=1)o(c);N()}},i(t){if(!a){for(let t=0;t<e.length;t+=1)g(n[t]);a=!0}},o(t){n=n.filter(Boolean);for(let s=0;s<n.length;s+=1)k(n[s]);a=!1},d(t){O(n,t),t&&r(s)}}}function G(t){let s,a,e=t[32].toString()in t[4],n=e&&M(t);return{c(){n&&n.c(),s=v()},l(t){n&&n.l(t),s=v()},m(t,e){n&&n.m(t,e),d(t,s,e),a=!0},p(t,a){16&a[0]&&(e=t[32].toString()in t[4]),e?n?(n.p(t,a),16&a[0]&&g(n,1)):(n=M(t),n.c(),g(n,1),n.m(s.parentNode,s)):n&&(I(),k(n,1,1,(()=>{n=null})),N())},i(t){a||(g(n),a=!0)},o(t){k(n),a=!1},d(t){n&&n.d(t),t&&r(s)}}}function M(t){let s,a,e=t[4][t[32].toString()].length>0,n=e&&Q(t);return{c(){n&&n.c(),s=v()},l(t){n&&n.l(t),s=v()},m(t,e){n&&n.m(t,e),d(t,s,e),a=!0},p(t,a){16&a[0]&&(e=t[4][t[32].toString()].length>0),e?n?(n.p(t,a),16&a[0]&&g(n,1)):(n=Q(t),n.c(),g(n,1),n.m(s.parentNode,s)):n&&(I(),k(n,1,1,(()=>{n=null})),N())},i(t){a||(g(n),a=!0)},o(t){k(n),a=!1},d(t){n&&n.d(t),t&&r(s)}}}function Q(t){let s,a,f,m,v,N,O=t[30].container_info.name+"";function T(s){t[15](s,t[32])}let y={title:t[30].container_info.name,headers:Object.keys(t[4][t[32].toString()][0])};return void 0!==t[4][t[32].toString()]&&(y.data=t[4][t[32].toString()]),m=new V({props:y}),B.push((()=>R(m,"data",T))),{c(){s=e("h5"),a=n(O),f=o(),w(m.$$.fragment)},l(t){s=c(t,"H5",{});var e=l(s);a=i(e,O),e.forEach(r),f=u(t),S(m.$$.fragment,t)},m(t,e){d(t,s,e),h(s,a),d(t,f,e),b(m,t,e),N=!0},p(s,e){t=s,(!N||1&e[0])&&O!==(O=t[30].container_info.name+"")&&p(a,O);const n={};1&e[0]&&(n.title=t[30].container_info.name),16&e[0]&&(n.headers=Object.keys(t[4][t[32].toString()][0])),!v&&16&e[0]&&(v=!0,n.data=t[4][t[32].toString()],E((()=>v=!1))),m.$set(n)},i(t){N||(g(m.$$.fragment,t),N=!0)},o(t){k(m.$$.fragment,t),N=!1},d(t){t&&r(s),t&&r(f),$(m,t)}}}function K(t){let s,a,e=Object.keys(t[4]).length>0,n=e&&G(t);return{c(){n&&n.c(),s=v()},l(t){n&&n.l(t),s=v()},m(t,e){n&&n.m(t,e),d(t,s,e),a=!0},p(t,a){16&a[0]&&(e=Object.keys(t[4]).length>0),e?n?(n.p(t,a),16&a[0]&&g(n,1)):(n=G(t),n.c(),g(n,1),n.m(s.parentNode,s)):n&&(I(),k(n,1,1,(()=>{n=null})),N())},i(t){a||(g(n),a=!0)},o(t){k(n),a=!1},d(t){n&&n.d(t),t&&r(s)}}}function X(t){let s,a,p,v,w,S,b,E,$,O,D,x,H,j,B,R,V,C,_,U,L,F,J,P,W=t[5].length>0&&Y(t);return{c(){s=e("div"),a=e("div"),p=e("button"),v=n("Start Simulation"),w=o(),S=e("hr"),b=o(),E=e("div"),$=e("h1"),O=e("b"),D=n("Edit Files"),x=o(),W&&W.c(),H=o(),j=e("hr"),B=o(),R=e("div"),V=e("div"),C=e("button"),_=n("Delete Files"),U=o(),L=e("hr"),this.h()},l(t){s=c(t,"DIV",{class:!0});var e=l(s);a=c(e,"DIV",{class:!0});var n=l(a);p=c(n,"BUTTON",{class:!0});var o=l(p);v=i(o,"Start Simulation"),o.forEach(r),n.forEach(r),e.forEach(r),w=u(t),S=c(t,"HR",{class:!0}),b=u(t),E=c(t,"DIV",{class:!0});var f=l(E);$=c(f,"H1",{class:!0,style:!0});var d=l($);O=c(d,"B",{});var h=l(O);D=i(h,"Edit Files"),h.forEach(r),d.forEach(r),f.forEach(r),x=u(t),W&&W.l(t),H=u(t),j=c(t,"HR",{class:!0}),B=u(t),R=c(t,"DIV",{class:!0});var m=l(R);V=c(m,"DIV",{class:!0});var g=l(V);C=c(g,"BUTTON",{class:!0});var k=l(C);_=i(k,"Delete Files"),k.forEach(r),g.forEach(r),m.forEach(r),U=u(t),L=c(t,"HR",{class:!0}),this.h()},h(){f(p,"class","w3-col w3-input w3-border"),f(a,"class","w3-rest"),f(s,"class","w3-row w3-section"),f(S,"class","svelte-drd2kv"),f($,"class","w3-text-yellow"),y($,"text-shadow","1px 1px 0 #444"),f(E,"class","w3-panel w3-blue"),f(j,"class","svelte-drd2kv"),f(C,"class","w3-col w3-input w3-border"),f(V,"class","w3-rest"),f(R,"class","w3-row w3-section"),f(L,"class","svelte-drd2kv")},m(e,n){d(e,s,n),h(s,a),h(a,p),h(p,v),d(e,w,n),d(e,S,n),d(e,b,n),d(e,E,n),h(E,$),h($,O),h(O,D),d(e,x,n),W&&W.m(e,n),d(e,H,n),d(e,j,n),d(e,B,n),d(e,R,n),h(R,V),h(V,C),h(C,_),d(e,U,n),d(e,L,n),F=!0,J||(P=[m(p,"click",t[9]),m(C,"click",t[11])],J=!0)},p(t,s){t[5].length>0?W?(W.p(t,s),32&s[0]&&g(W,1)):(W=Y(t),W.c(),g(W,1),W.m(H.parentNode,H)):W&&(I(),k(W,1,1,(()=>{W=null})),N())},i(t){F||(g(W),F=!0)},o(t){k(W),F=!1},d(t){t&&r(s),t&&r(w),t&&r(S),t&&r(b),t&&r(E),t&&r(x),W&&W.d(t),t&&r(H),t&&r(j),t&&r(B),t&&r(R),t&&r(U),t&&r(L),J=!1,T(P)}}}function Y(t){let s,a,e;function n(s){t[16](s)}let o={title:"static simulation data",headers:Object.keys(t[5][0])};return void 0!==t[5]&&(o.data=t[5]),s=new V({props:o}),B.push((()=>R(s,"data",n))),{c(){w(s.$$.fragment)},l(t){S(s.$$.fragment,t)},m(t,a){b(s,t,a),e=!0},p(t,e){const n={};32&e[0]&&(n.headers=Object.keys(t[5][0])),!a&&32&e[0]&&(a=!0,n.data=t[5],E((()=>a=!1))),s.$set(n)},i(t){e||(g(s.$$.fragment,t),e=!0)},o(t){k(s.$$.fragment,t),e=!1},d(t){$(s,t)}}}function Z(t){let s,a,o,u,p,g;return{c(){s=e("div"),a=e("div"),o=e("button"),u=n("Start Simulation"),this.h()},l(t){s=c(t,"DIV",{class:!0});var e=l(s);a=c(e,"DIV",{class:!0});var n=l(a);o=c(n,"BUTTON",{class:!0});var f=l(o);u=i(f,"Start Simulation"),f.forEach(r),n.forEach(r),e.forEach(r),this.h()},h(){f(o,"class","w3-col w3-input w3-border"),f(a,"class","w3-rest"),f(s,"class","w3-row w3-section")},m(e,n){d(e,s,n),h(s,a),h(a,o),h(o,u),p||(g=m(o,"click",t[10]),p=!0)},p:D,d(t){t&&r(s),p=!1,g()}}}function tt(t){let s,a,m,p,v,E,O,T,D,H,j,B,R,V,_,U,L;a=new C({});let F="Communication"==t[1]&&q(t),J="Static"==t[1]&&X(t),P="Driving Simulation"==t[1]&&Z(t);return{c(){s=o(),w(a.$$.fragment),m=o(),p=e("hr"),v=o(),E=e("div"),O=e("h1"),T=e("b"),D=n("Simulation"),H=o(),j=e("hr"),B=o(),F&&F.c(),R=o(),J&&J.c(),V=o(),P&&P.c(),_=o(),U=e("hr"),this.h()},l(t){x('[data-svelte="svelte-1smsifb"]',document.head).forEach(r),s=u(t),S(a.$$.fragment,t),m=u(t),p=c(t,"HR",{class:!0}),v=u(t),E=c(t,"DIV",{class:!0});var e=l(E);O=c(e,"H1",{class:!0,style:!0});var n=l(O);T=c(n,"B",{});var o=l(T);D=i(o,"Simulation"),o.forEach(r),n.forEach(r),e.forEach(r),H=u(t),j=c(t,"HR",{class:!0}),B=u(t),F&&F.l(t),R=u(t),J&&J.l(t),V=u(t),P&&P.l(t),_=u(t),U=c(t,"HR",{class:!0}),this.h()},h(){document.title="Simulation",f(p,"class","svelte-drd2kv"),f(O,"class","w3-text-yellow"),y(O,"text-shadow","1px 1px 0 #444"),f(E,"class","w3-panel w3-blue"),f(j,"class","svelte-drd2kv"),f(U,"class","svelte-drd2kv")},m(t,e){d(t,s,e),b(a,t,e),d(t,m,e),d(t,p,e),d(t,v,e),d(t,E,e),h(E,O),h(O,T),h(T,D),d(t,H,e),d(t,j,e),d(t,B,e),F&&F.m(t,e),d(t,R,e),J&&J.m(t,e),d(t,V,e),P&&P.m(t,e),d(t,_,e),d(t,U,e),L=!0},p(t,s){"Communication"==t[1]?F?(F.p(t,s),2&s[0]&&g(F,1)):(F=q(t),F.c(),g(F,1),F.m(R.parentNode,R)):F&&(I(),k(F,1,1,(()=>{F=null})),N()),"Static"==t[1]?J?(J.p(t,s),2&s[0]&&g(J,1)):(J=X(t),J.c(),g(J,1),J.m(V.parentNode,V)):J&&(I(),k(J,1,1,(()=>{J=null})),N()),"Driving Simulation"==t[1]?P?P.p(t,s):(P=Z(t),P.c(),P.m(_.parentNode,_)):P&&(P.d(1),P=null)},i(t){L||(g(a.$$.fragment,t),g(F),g(J),L=!0)},o(t){k(a.$$.fragment,t),k(F),k(J),L=!1},d(t){t&&r(s),$(a,t),t&&r(m),t&&r(p),t&&r(v),t&&r(E),t&&r(H),t&&r(j),t&&r(B),F&&F.d(t),t&&r(R),J&&J.d(t),t&&r(V),P&&P.d(t),t&&r(_),t&&r(U)}}}function st(t,s,a){let e=[],n={},o="";const c=F.subscribe((t=>{e=t})),l=J.subscribe((t=>{a(0,n=t)})),i=P.subscribe((t=>{a(1,o=t)}));let r=[],u=[];H((()=>{c(),l(),i();for(let t=0;t<r.length;t++)r[t].close();for(let t=0;t<u.length;t++)u[t].close()}));let f="Please create and select a scenario before starting the simulation.",d=!1,h=0,m=[],p={},g=[];function v(){for(const[t,s]of Object.entries(p))a(4,p[t]=[],p)}async function w(t){if(!d)return void U.danger("please create and activate a scenario first.");"start"==t&&v(),L("/simulation/comm","POST",{command:t,configs:n},(function(t){t.data&&(U.success("simulation started."),console.log("response of simulation",t.data))}))}function S(){for(var t=0;t<r.length;t++)ws=r[t],ws.close()}j((async()=>{let t="";for(let s=0;s<e.length;s++)e[s].activated&&(a(2,f=e[s].name),d=!0,t="/api/db1/scenario_configurations/ref-"+e[s]._id);!function(t,s){_(t,(function(t){let a=JSON.parse(t.response);a.data&&a.data.length>0&&(J.set(a.data[0]),s())}))}(t,(function(){if("Communication"==n.type){"configurations"in n&&a(3,h=n.configurations.length);for(var t=0;t<h;t++){a(4,p[t.toString()]=[],p);let s="ws://localhost:8000/simulation/comm/ws/"+t.toString(),e=new WebSocket(s);e.onopen=function(){window.console.log("Successfully connected to the echo websocket server...")},e.onmessage=function(t){let s=JSON.parse(t.data);console.log(s,"printing JSON now");let e=s.client_index,n=JSON.parse(s.data);"status"in n?m[e]=n.status:a(4,p[e]=[...p[e],n],p)},r.push(e)}}if("Static"==n.type){console.log("hello static sample");let t=new WebSocket("ws://localhost:8000/simulation/static/ws");t.onopen=function(){window.console.log("static simulation websocket")},t.onmessage=function(t){let s=JSON.parse(t.data);a(5,g=[...g,s])},u.push(t)}"Communication"==n.type&&console.log("hello driving scenario")}))}));return[n,o,f,h,p,g,v,w,S,function(){L("/simulation/static","POST",{configs:n},(function(t){t.data&&(U.success("simulation started."),console.log("response of simulation",t.data))}))},function(){L("/simulation/static","POST",{configs:n},(function(t){t.data&&(U.success("simulation started."),console.log("response of simulation",t.data))}))},function(){L("/simulation/static","DELETE",{configs:n},(function(t){t.data&&(U.success("Delete successful."),console.log("response of simulation",t.data))}))},()=>w("start"),()=>w("stop"),()=>S(),function(s,e){t.$$.not_equal(p[e.toString()],s)&&(p[e.toString()]=s,a(4,p))},function(t){g=t,a(5,g)}]}export default class extends t{constructor(t){super(),s(this,t,st,tt,a,{},[-1,-1])}}
