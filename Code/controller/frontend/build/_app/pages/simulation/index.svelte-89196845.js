import{S as t,i as n,s as a,l as o,f as e,v as s,t as r,k as l,g as c,n as i,e as f,j as u,c as g,a as d,d as h,m,F as p,o as w,h as v,a5 as S,r as b,w as k,u as $,M as N,L as E,b as O,N as j,G as y,Q as T,R as x,z as H,B as _,a3 as B,a4 as R}from"../../chunks/vendor-5cf7a4b5.js";import{T as C}from"../../chunks/index-a1695e4a.js";import{T as D,n as I,a as L}from"../../chunks/requests-f597ce78.js";import{s as V,a as J}from"../../chunks/store-f8ef346b.js";function U(t,n,a){const o=t.slice();return o[17]=n[a],o[18]=n,o[19]=a,o}function q(t){let n,a,r=t[0].configurations.length>0&&A(t);return{c(){r&&r.c(),n=o()},l(t){r&&r.l(t),n=o()},m(t,o){r&&r.m(t,o),e(t,n,o),a=!0},p(t,a){t[0].configurations.length>0?r?(r.p(t,a),1&a&&s(r,1)):(r=A(t),r.c(),s(r,1),r.m(n.parentNode,n)):r&&(_(),b(r,1,1,(()=>{r=null})),$())},i(t){a||(s(r),a=!0)},o(t){b(r),a=!1},d(t){r&&r.d(t),t&&h(n)}}}function A(t){let n,a,r=t[0].configurations,l=[];for(let o=0;o<r.length;o+=1)l[o]=G(U(t,r,o));const c=t=>b(l[t],1,1,(()=>{l[t]=null}));return{c(){for(let t=0;t<l.length;t+=1)l[t].c();n=o()},l(t){for(let n=0;n<l.length;n+=1)l[n].l(t);n=o()},m(t,o){for(let n=0;n<l.length;n+=1)l[n].m(t,o);e(t,n,o),a=!0},p(t,a){if(9&a){let o;for(r=t[0].configurations,o=0;o<r.length;o+=1){const e=U(t,r,o);l[o]?(l[o].p(e,a),s(l[o],1)):(l[o]=G(e),l[o].c(),s(l[o],1),l[o].m(n.parentNode,n))}for(_(),o=r.length;o<l.length;o+=1)c(o);$()}},i(t){if(!a){for(let t=0;t<r.length;t+=1)s(l[t]);a=!0}},o(t){l=l.filter(Boolean);for(let n=0;n<l.length;n+=1)b(l[n]);a=!1},d(t){N(l,t),t&&h(n)}}}function P(t){let n,a,r=t[19].toString()in t[3],l=r&&z(t);return{c(){l&&l.c(),n=o()},l(t){l&&l.l(t),n=o()},m(t,o){l&&l.m(t,o),e(t,n,o),a=!0},p(t,a){8&a&&(r=t[19].toString()in t[3]),r?l?(l.p(t,a),8&a&&s(l,1)):(l=z(t),l.c(),s(l,1),l.m(n.parentNode,n)):l&&(_(),b(l,1,1,(()=>{l=null})),$())},i(t){a||(s(l),a=!0)},o(t){b(l),a=!1},d(t){l&&l.d(t),t&&h(n)}}}function z(t){let n,a,r=t[3][t[19].toString()].length>0,l=r&&F(t);return{c(){l&&l.c(),n=o()},l(t){l&&l.l(t),n=o()},m(t,o){l&&l.m(t,o),e(t,n,o),a=!0},p(t,a){8&a&&(r=t[3][t[19].toString()].length>0),r?l?(l.p(t,a),8&a&&s(l,1)):(l=F(t),l.c(),s(l,1),l.m(n.parentNode,n)):l&&(_(),b(l,1,1,(()=>{l=null})),$())},i(t){a||(s(l),a=!0)},o(t){b(l),a=!1},d(t){l&&l.d(t),t&&h(n)}}}function F(t){let n,a,o,$,N,E,O,j=t[17].container_info.name+"";function y(n){t[8](n,t[19])}let T={title:t[17].container_info.name,headers:Object.keys(t[3][t[19].toString()][0])};return void 0!==t[3][t[19].toString()]&&(T.data=t[3][t[19].toString()]),$=new C({props:T}),B.push((()=>R($,"data",y))),{c(){n=f("h5"),a=r(j),o=l(),u($.$$.fragment),E=l()},l(t){n=g(t,"H5",{});var e=d(n);a=c(e,j),e.forEach(h),o=i(t),m($.$$.fragment,t),E=i(t)},m(t,s){e(t,n,s),p(n,a),e(t,o,s),w($,t,s),e(t,E,s),O=!0},p(n,o){t=n,(!O||1&o)&&j!==(j=t[17].container_info.name+"")&&v(a,j);const e={};1&o&&(e.title=t[17].container_info.name),8&o&&(e.headers=Object.keys(t[3][t[19].toString()][0])),!N&&8&o&&(N=!0,e.data=t[3][t[19].toString()],S((()=>N=!1))),$.$set(e)},i(t){O||(s($.$$.fragment,t),O=!0)},o(t){b($.$$.fragment,t),O=!1},d(t){t&&h(n),t&&h(o),k($,t),t&&h(E)}}}function G(t){let n,a,f,u,g,d=typeof t[19],m=Object.keys(t[3]).length>0,p=m&&P(t);return{c(){n=r("iteration works "),a=r(d),f=l(),p&&p.c(),u=o()},l(t){n=c(t,"iteration works "),a=c(t,d),f=i(t),p&&p.l(t),u=o()},m(t,o){e(t,n,o),e(t,a,o),e(t,f,o),p&&p.m(t,o),e(t,u,o),g=!0},p(t,n){8&n&&(m=Object.keys(t[3]).length>0),m?p?(p.p(t,n),8&n&&s(p,1)):(p=P(t),p.c(),s(p,1),p.m(u.parentNode,u)):p&&(_(),b(p,1,1,(()=>{p=null})),$())},i(t){g||(s(p),g=!0)},o(t){b(p),g=!1},d(t){t&&h(n),t&&h(a),t&&h(f),p&&p.d(t),t&&h(u)}}}function M(t){let n,a,o,S,N,x,H,B,R,C,I,L,V,J,U,A,P,z,F,G,M,Q,W,K,X,Y,Z,tt,nt,at,ot,et,st,rt,lt,ct,it,ft,ut,gt,dt,ht,mt,pt;a=new D({});let wt="configurations"in t[0]&&q(t);return{c(){n=l(),u(a.$$.fragment),o=l(),S=f("hr"),N=l(),x=f("div"),H=f("h1"),B=f("b"),R=r("Simulation"),C=l(),I=f("hr"),L=l(),V=f("h4"),J=r("Scenario: "),U=r(t[1]),A=r(" Number of Containers: "),P=r(t[2]),z=r("."),F=l(),G=f("div"),M=f("div"),Q=f("button"),W=r("Start Simulation"),K=l(),X=f("div"),Y=f("button"),Z=r("Stop Simulation"),tt=l(),nt=f("hr"),at=l(),ot=f("section"),et=f("h3"),st=r("Application Logs"),rt=l(),lt=f("button"),ct=r("Clear Logs"),it=l(),wt&&wt.c(),ft=l(),ut=f("br"),gt=l(),dt=f("hr"),this.h()},l(e){E('[data-svelte="svelte-1smsifb"]',document.head).forEach(h),n=i(e),m(a.$$.fragment,e),o=i(e),S=g(e,"HR",{class:!0}),N=i(e),x=g(e,"DIV",{class:!0});var s=d(x);H=g(s,"H1",{class:!0,style:!0});var r=d(H);B=g(r,"B",{});var l=d(B);R=c(l,"Simulation"),l.forEach(h),r.forEach(h),s.forEach(h),C=i(e),I=g(e,"HR",{class:!0}),L=i(e),V=g(e,"H4",{});var f=d(V);J=c(f,"Scenario: "),U=c(f,t[1]),A=c(f," Number of Containers: "),P=c(f,t[2]),z=c(f,"."),f.forEach(h),F=i(e),G=g(e,"DIV",{class:!0});var u=d(G);M=g(u,"DIV",{class:!0});var p=d(M);Q=g(p,"BUTTON",{class:!0});var w=d(Q);W=c(w,"Start Simulation"),w.forEach(h),p.forEach(h),K=i(u),X=g(u,"DIV",{class:!0});var v=d(X);Y=g(v,"BUTTON",{class:!0});var b=d(Y);Z=c(b,"Stop Simulation"),b.forEach(h),v.forEach(h),u.forEach(h),tt=i(e),nt=g(e,"HR",{class:!0}),at=i(e),ot=g(e,"SECTION",{class:!0});var k=d(ot);et=g(k,"H3",{});var $=d(et);st=c($,"Application Logs"),$.forEach(h),k.forEach(h),rt=i(e),lt=g(e,"BUTTON",{class:!0});var O=d(lt);ct=c(O,"Clear Logs"),O.forEach(h),it=i(e),wt&&wt.l(e),ft=i(e),ut=g(e,"BR",{}),gt=i(e),dt=g(e,"HR",{class:!0}),this.h()},h(){document.title="Simulation",O(S,"class","svelte-drd2kv"),O(H,"class","w3-text-yellow"),j(H,"text-shadow","1px 1px 0 #444"),O(x,"class","w3-panel w3-blue"),O(I,"class","svelte-drd2kv"),O(Q,"class","w3-col w3-input w3-border w3-margin"),O(M,"class","w3-half"),O(Y,"class","w3-col w3-input w3-border w3-margin"),O(X,"class","w3-half"),O(G,"class","w3-row w3-section"),O(nt,"class","svelte-drd2kv"),O(ot,"class","page-headline"),O(lt,"class","w3-col w3-input w3-border w3-button"),O(dt,"class","svelte-drd2kv")},m(s,r){e(s,n,r),w(a,s,r),e(s,o,r),e(s,S,r),e(s,N,r),e(s,x,r),p(x,H),p(H,B),p(B,R),e(s,C,r),e(s,I,r),e(s,L,r),e(s,V,r),p(V,J),p(V,U),p(V,A),p(V,P),p(V,z),e(s,F,r),e(s,G,r),p(G,M),p(M,Q),p(Q,W),p(G,K),p(G,X),p(X,Y),p(Y,Z),e(s,tt,r),e(s,nt,r),e(s,at,r),e(s,ot,r),p(ot,et),p(et,st),e(s,rt,r),e(s,lt,r),p(lt,ct),e(s,it,r),wt&&wt.m(s,r),e(s,ft,r),e(s,ut,r),e(s,gt,r),e(s,dt,r),ht=!0,mt||(pt=[y(Q,"click",t[6]),y(Y,"click",t[7]),y(lt,"click",t[4])],mt=!0)},p(t,[n]){(!ht||2&n)&&v(U,t[1]),(!ht||4&n)&&v(P,t[2]),"configurations"in t[0]?wt?(wt.p(t,n),1&n&&s(wt,1)):(wt=q(t),wt.c(),s(wt,1),wt.m(ft.parentNode,ft)):wt&&(_(),b(wt,1,1,(()=>{wt=null})),$())},i(t){ht||(s(a.$$.fragment,t),s(wt),ht=!0)},o(t){b(a.$$.fragment,t),b(wt),ht=!1},d(t){t&&h(n),k(a,t),t&&h(o),t&&h(S),t&&h(N),t&&h(x),t&&h(C),t&&h(I),t&&h(L),t&&h(V),t&&h(F),t&&h(G),t&&h(tt),t&&h(nt),t&&h(at),t&&h(ot),t&&h(rt),t&&h(lt),t&&h(it),wt&&wt.d(t),t&&h(ft),t&&h(ut),t&&h(gt),t&&h(dt),mt=!1,T(pt)}}}function Q(t,n,a){let o=[],e={};const s=V.subscribe((t=>{o=t})),r=J.subscribe((t=>{a(0,e=t)}));let l=[];x((()=>{s(),r();for(let t=0;t<l.length;t++)l[t].close()}));let c="Please create and select a scenario before starting the simulation.",i=!1,f=0,u=[],g={};function d(){for(const[t,n]of Object.entries(g))a(3,g[t]=[],g)}async function h(t){if(!i)return void I.danger("please create and activate a scenario first.");d(),console.log("start or stop simulation"),L("/simulation","POST",{command:t,configs:e},(function(t){t.data&&console.log("response of start simulation",t.data)}))}H((async()=>{for(let n=0;n<o.length;n++)o[n].activated&&(a(1,c=o[n].name),i=!0);"configurations"in e&&a(2,f=e.configurations.length),console.log("scenarios",o),console.log("scenario_configurations",e),l=[];for(var t=0;t<f;t++){a(3,g[t.toString()]=[],g);let n="ws://localhost:8000/simulation/ws/"+t.toString();console.log("ws url:",n);let o=new WebSocket(n);o.onopen=function(){window.console.log("Successfully connected to the echo websocket server...")},o.onmessage=function(t){window.console.log(t,"received ws message");let n=JSON.parse(t.data);console.log(n,"printing JSON now");let o=n.client_index,e=JSON.parse(n.data);console.log("containerData",e),"status"in e?u[o]=e.status:a(3,g[o]=[...g[o],e],g),console.log(g,"ws_data printing")},l.push(o)}}));return[e,c,f,g,d,h,()=>h("start"),()=>h("stop"),function(n,o){t.$$.not_equal(g[o.toString()],n)&&(g[o.toString()]=n,a(3,g))}]}export default class extends t{constructor(t){super(),n(this,t,Q,M,a,{})}}
