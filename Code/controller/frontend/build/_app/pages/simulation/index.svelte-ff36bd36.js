import{S as t,i as s,s as a,l as o,f as n,v as e,t as r,k as l,g as c,n as i,j as f,m as u,o as g,a5 as d,r as h,w as m,d as p,u as w,M as v,e as S,L as b,c as k,a as $,b as E,N,F as O,G as j,h as y,Q as T,R as x,z as _,B,a3 as H,a4 as R}from"../../chunks/vendor-5cf7a4b5.js";import{T as C}from"../../chunks/index-a1695e4a.js";import{T as D,n as I,a as L}from"../../chunks/requests-f597ce78.js";import{s as V,a as J}from"../../chunks/store-f8ef346b.js";function U(t,s,a){const o=t.slice();return o[17]=s[a],o[18]=s,o[19]=a,o}function q(t){let s,a,r=t[0].configurations.length>0&&A(t);return{c(){r&&r.c(),s=o()},l(t){r&&r.l(t),s=o()},m(t,o){r&&r.m(t,o),n(t,s,o),a=!0},p(t,a){t[0].configurations.length>0?r?(r.p(t,a),1&a&&e(r,1)):(r=A(t),r.c(),e(r,1),r.m(s.parentNode,s)):r&&(B(),h(r,1,1,(()=>{r=null})),w())},i(t){a||(e(r),a=!0)},o(t){h(r),a=!1},d(t){r&&r.d(t),t&&p(s)}}}function A(t){let s,a,r=t[0].configurations,l=[];for(let o=0;o<r.length;o+=1)l[o]=z(U(t,r,o));const c=t=>h(l[t],1,1,(()=>{l[t]=null}));return{c(){for(let t=0;t<l.length;t+=1)l[t].c();s=o()},l(t){for(let s=0;s<l.length;s+=1)l[s].l(t);s=o()},m(t,o){for(let s=0;s<l.length;s+=1)l[s].m(t,o);n(t,s,o),a=!0},p(t,a){if(9&a){let o;for(r=t[0].configurations,o=0;o<r.length;o+=1){const n=U(t,r,o);l[o]?(l[o].p(n,a),e(l[o],1)):(l[o]=z(n),l[o].c(),e(l[o],1),l[o].m(s.parentNode,s))}for(B(),o=r.length;o<l.length;o+=1)c(o);w()}},i(t){if(!a){for(let t=0;t<r.length;t+=1)e(l[t]);a=!0}},o(t){l=l.filter(Boolean);for(let s=0;s<l.length;s+=1)h(l[s]);a=!1},d(t){v(l,t),t&&p(s)}}}function P(t){let s,a,o,r;function c(s){t[8](s,t[19])}let w={title:t[17].container_info.name,headers:Object.keys(t[3][t[19].toString()][0])};return void 0!==t[3][t[19].toString()]&&(w.data=t[3][t[19].toString()]),s=new C({props:w}),H.push((()=>R(s,"data",c))),{c(){f(s.$$.fragment),o=l()},l(t){u(s.$$.fragment,t),o=i(t)},m(t,a){g(s,t,a),n(t,o,a),r=!0},p(o,n){t=o;const e={};1&n&&(e.title=t[17].container_info.name),8&n&&(e.headers=Object.keys(t[3][t[19].toString()][0])),!a&&8&n&&(a=!0,e.data=t[3][t[19].toString()],d((()=>a=!1))),s.$set(e)},i(t){r||(e(s.$$.fragment,t),r=!0)},o(t){h(s.$$.fragment,t),r=!1},d(t){m(s,t),t&&p(o)}}}function z(t){let s,a,f,u,g,d=typeof t[19],m=Object.keys(t[3]).length>0,v=m&&P(t);return{c(){s=r("iteration works "),a=r(d),f=l(),v&&v.c(),u=o()},l(t){s=c(t,"iteration works "),a=c(t,d),f=i(t),v&&v.l(t),u=o()},m(t,o){n(t,s,o),n(t,a,o),n(t,f,o),v&&v.m(t,o),n(t,u,o),g=!0},p(t,s){8&s&&(m=Object.keys(t[3]).length>0),m?v?(v.p(t,s),8&s&&e(v,1)):(v=P(t),v.c(),e(v,1),v.m(u.parentNode,u)):v&&(B(),h(v,1,1,(()=>{v=null})),w())},i(t){g||(e(v),g=!0)},o(t){h(v),g=!1},d(t){t&&p(s),t&&p(a),t&&p(f),v&&v.d(t),t&&p(u)}}}function F(t){let s,a,o,d,v,x,_,H,R,C,I,L,V,J,U,A,P,z,F,G,M,Q,W,K,X,Y,Z,tt,st,at,ot,nt,et,rt,lt,ct,it,ft,ut,gt,dt,ht,mt,pt;a=new D({});let wt="configurations"in t[0]&&q(t);return{c(){s=l(),f(a.$$.fragment),o=l(),d=S("hr"),v=l(),x=S("div"),_=S("h1"),H=S("b"),R=r("Simulation"),C=l(),I=S("hr"),L=l(),V=S("h4"),J=r("Scenario: "),U=r(t[1]),A=r(" Number of Containers: "),P=r(t[2]),z=r("."),F=l(),G=S("div"),M=S("div"),Q=S("button"),W=r("Start Simulation"),K=l(),X=S("div"),Y=S("button"),Z=r("Stop Simulation"),tt=l(),st=S("hr"),at=l(),ot=S("section"),nt=S("h3"),et=r("Application Logs"),rt=l(),lt=S("button"),ct=r("Clear Logs"),it=l(),wt&&wt.c(),ft=l(),ut=S("br"),gt=l(),dt=S("hr"),this.h()},l(n){b('[data-svelte="svelte-1smsifb"]',document.head).forEach(p),s=i(n),u(a.$$.fragment,n),o=i(n),d=k(n,"HR",{class:!0}),v=i(n),x=k(n,"DIV",{class:!0});var e=$(x);_=k(e,"H1",{class:!0,style:!0});var r=$(_);H=k(r,"B",{});var l=$(H);R=c(l,"Simulation"),l.forEach(p),r.forEach(p),e.forEach(p),C=i(n),I=k(n,"HR",{class:!0}),L=i(n),V=k(n,"H4",{});var f=$(V);J=c(f,"Scenario: "),U=c(f,t[1]),A=c(f," Number of Containers: "),P=c(f,t[2]),z=c(f,"."),f.forEach(p),F=i(n),G=k(n,"DIV",{class:!0});var g=$(G);M=k(g,"DIV",{class:!0});var h=$(M);Q=k(h,"BUTTON",{class:!0});var m=$(Q);W=c(m,"Start Simulation"),m.forEach(p),h.forEach(p),K=i(g),X=k(g,"DIV",{class:!0});var w=$(X);Y=k(w,"BUTTON",{class:!0});var S=$(Y);Z=c(S,"Stop Simulation"),S.forEach(p),w.forEach(p),g.forEach(p),tt=i(n),st=k(n,"HR",{class:!0}),at=i(n),ot=k(n,"SECTION",{class:!0});var E=$(ot);nt=k(E,"H3",{});var N=$(nt);et=c(N,"Application Logs"),N.forEach(p),E.forEach(p),rt=i(n),lt=k(n,"BUTTON",{class:!0});var O=$(lt);ct=c(O,"Clear Logs"),O.forEach(p),it=i(n),wt&&wt.l(n),ft=i(n),ut=k(n,"BR",{}),gt=i(n),dt=k(n,"HR",{class:!0}),this.h()},h(){document.title="Simulation",E(d,"class","svelte-drd2kv"),E(_,"class","w3-text-yellow"),N(_,"text-shadow","1px 1px 0 #444"),E(x,"class","w3-panel w3-blue"),E(I,"class","svelte-drd2kv"),E(Q,"class","w3-col w3-input w3-border w3-margin"),E(M,"class","w3-half"),E(Y,"class","w3-col w3-input w3-border w3-margin"),E(X,"class","w3-half"),E(G,"class","w3-row w3-section"),E(st,"class","svelte-drd2kv"),E(ot,"class","page-headline"),E(lt,"class","w3-col w3-input w3-border w3-button"),E(dt,"class","svelte-drd2kv")},m(e,r){n(e,s,r),g(a,e,r),n(e,o,r),n(e,d,r),n(e,v,r),n(e,x,r),O(x,_),O(_,H),O(H,R),n(e,C,r),n(e,I,r),n(e,L,r),n(e,V,r),O(V,J),O(V,U),O(V,A),O(V,P),O(V,z),n(e,F,r),n(e,G,r),O(G,M),O(M,Q),O(Q,W),O(G,K),O(G,X),O(X,Y),O(Y,Z),n(e,tt,r),n(e,st,r),n(e,at,r),n(e,ot,r),O(ot,nt),O(nt,et),n(e,rt,r),n(e,lt,r),O(lt,ct),n(e,it,r),wt&&wt.m(e,r),n(e,ft,r),n(e,ut,r),n(e,gt,r),n(e,dt,r),ht=!0,mt||(pt=[j(Q,"click",t[6]),j(Y,"click",t[7]),j(lt,"click",t[4])],mt=!0)},p(t,[s]){(!ht||2&s)&&y(U,t[1]),(!ht||4&s)&&y(P,t[2]),"configurations"in t[0]?wt?(wt.p(t,s),1&s&&e(wt,1)):(wt=q(t),wt.c(),e(wt,1),wt.m(ft.parentNode,ft)):wt&&(B(),h(wt,1,1,(()=>{wt=null})),w())},i(t){ht||(e(a.$$.fragment,t),e(wt),ht=!0)},o(t){h(a.$$.fragment,t),h(wt),ht=!1},d(t){t&&p(s),m(a,t),t&&p(o),t&&p(d),t&&p(v),t&&p(x),t&&p(C),t&&p(I),t&&p(L),t&&p(V),t&&p(F),t&&p(G),t&&p(tt),t&&p(st),t&&p(at),t&&p(ot),t&&p(rt),t&&p(lt),t&&p(it),wt&&wt.d(t),t&&p(ft),t&&p(ut),t&&p(gt),t&&p(dt),mt=!1,T(pt)}}}function G(t,s,a){let o=[],n={};const e=V.subscribe((t=>{o=t})),r=J.subscribe((t=>{a(0,n=t)}));let l=[];x((()=>{e(),r();for(let t=0;t<l.length;t++)l[t].close()}));let c="Please create and select a scenario before starting the simulation.",i=!1,f=0,u=[],g={};function d(){for(const[t,s]of Object.entries(g))a(3,g[t]=[],g)}async function h(t){if(!i)return void I.danger("please create and activate a scenario first.");d(),console.log("start or stop simulation"),L("/simulation","POST",{command:t,configs:n},(function(t){t.data&&console.log("response of start simulation",t.data)}))}_((async()=>{for(let s=0;s<o.length;s++)o[s].activated&&(a(1,c=o[s].name),i=!0);"configurations"in n&&a(2,f=n.configurations.length),console.log("scenarios",o),console.log("scenario_configurations",n),l=[];for(var t=0;t<f;t++){a(3,g[t.toString()]=[],g);let s="ws://localhost:8000/simulation/ws/"+n.configurations[t].container_info.name+"/"+n.configurations[t].container_info.ports.split(",")[0].split("/")[0]+"/"+t.toString();console.log("ws url:",s);let o=new WebSocket(s);o.onopen=function(){window.console.log("Successfully connected to the echo websocket server...")},o.onmessage=function(t){window.console.log(t,"received ws message");let s=JSON.parse(t.data);console.log(s,"printing JSON now");let o=s.client_index,n=JSON.parse(s.data);a(3,g[o]=[...g[o],n],g),console.log("containerData",n),"status"in n&&(u[o]=n.status),console.log(g,"ws_data printing")},l.push(o)}}));return[n,c,f,g,d,h,()=>h("start"),()=>h("stop"),function(s,o){t.$$.not_equal(g[o.toString()],s)&&(g[o.toString()]=s,a(3,g))}]}export default class extends t{constructor(t){super(),s(this,t,G,F,a,{})}}
